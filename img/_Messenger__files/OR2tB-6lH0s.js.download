if (self.CavalryLogger) { CavalryLogger.start_js(["r6cib"]); }

__d("NotifType",[],(function a(b,c,d,e,f,g){f.exports={LIKE:"like",OPEN_GRAPH_ACTION_LIKE:"open_graph_action_like",LIKE_TAGGED:"like_tagged",PAGE_FAN:"page_fan",IG_MEDIA_LIKE:"ig_media_like",FEEDBACK_REACTION_GENERIC:"feedback_reaction_generic",FEEDBACK_REACTION_GENERIC_TAGGED:"feedback_reaction_generic_tagged",MESSENGER_REACTIONS:"messenger_reactions",MARKETPLACE_RECEIVED_RATING:"marketplace_received_rating",MARKETPLACE_RECEIVED_RATING_COMPLETED:"marketplace_received_rating_completed"}}),null);
__d("NotificationGenericBucket",["NotificationSeenState"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){this.$NotificationGenericBucket2=[];this.$NotificationGenericBucket3={};this.$NotificationGenericBucket4={};this.$NotificationGenericBucket7=function(j,k){var l=this.$NotificationGenericBucket4[j],m=this.$NotificationGenericBucket4[k];return Number(m)-Number(l)}.bind(this);this.$NotificationGenericBucket1=i}h.prototype.reset=function(){this.$NotificationGenericBucket2=[];this.$NotificationGenericBucket3={};this.$NotificationGenericBucket4={}};h.prototype.getType=function(){return this.$NotificationGenericBucket1.bucket_type};h.prototype.getTitle=function(){return this.$NotificationGenericBucket1.title};h.prototype.getSortedIDs=function(){return this.$NotificationGenericBucket2.slice()};h.prototype.insertIfEligible=function(i){var j=this.$NotificationGenericBucket5(i);if(!j.eligible)return j;this.$NotificationGenericBucket6(i);return{eligible:true}};h.prototype.remove=function(i){if(!this.$NotificationGenericBucket3[i])return false;delete this.$NotificationGenericBucket3[i];delete this.$NotificationGenericBucket4[i];var j=this.$NotificationGenericBucket2.indexOf(i);j>-1&&this.$NotificationGenericBucket2.splice(j,1);return true};h.prototype.$NotificationGenericBucket6=function(i){__p&&__p();var j=i.alert_id;if(this.$NotificationGenericBucket3[j])return true;this.$NotificationGenericBucket2.push(j);this.$NotificationGenericBucket3[j]=true;var k=this.$NotificationGenericBucket8(this.$NotificationGenericBucket1.sort_key_index);if(k>-1){var l=i.sort_keys?i.sort_keys[k]:null;if(l){this.$NotificationGenericBucket4[j]=l;this.$NotificationGenericBucket9()}}return true};h.prototype.$NotificationGenericBucket9=function(){this.$NotificationGenericBucket2.sort(this.$NotificationGenericBucket7)};h.prototype.$NotificationGenericBucket5=function(i){__p&&__p();if(!this.$NotificationGenericBucket10(i))return{eligible:false,type:"bucket",data:i.eligible_buckets};if(!this.$NotificationGenericBucket11(i))return{eligible:false,type:"exp_time"};if(!this.$NotificationGenericBucket12(i))return{eligible:false,type:"seen_filter"};if(!this.$NotificationGenericBucket13(i))return{eligible:false,type:"max_count"};if(!this.$NotificationGenericBucket14(i))return{eligible:false,type:"seen_evict",data:this.$NotificationGenericBucket15(i)};if(!this.$NotificationGenericBucket16(i))return{eligible:false,type:"read_evict"};return{eligible:true}};h.prototype.$NotificationGenericBucket8=function(i){return Number.isInteger(i)?Number(i):-1};h.prototype.$NotificationGenericBucket10=function(i){if(!i.eligible_buckets)return false;return i.eligible_buckets.includes(this.getType())};h.prototype.$NotificationGenericBucket12=function(i){return c("NotificationSeenState").validateFilter(i.alert_id,this.$NotificationGenericBucket1.seen_filter)};h.prototype.$NotificationGenericBucket11=function(i){var j=this.$NotificationGenericBucket8(this.$NotificationGenericBucket1.min_to_expire);return j===-1?true:Date.now()-i.creation_time<j*60*1e3};h.prototype.$NotificationGenericBucket13=function(i){var j=this.$NotificationGenericBucket8(this.$NotificationGenericBucket1.max_count);return j===-1?true:this.$NotificationGenericBucket2.length<j};h.prototype.$NotificationGenericBucket15=function(i){var j=this.$NotificationGenericBucket8(this.$NotificationGenericBucket1.sec_to_evict_seen);return{secToEvict:j,firstTime:i.first_seen_time||0,currentTime:Date.now()/1e3}};h.prototype.$NotificationGenericBucket17=function(i){var j=this.$NotificationGenericBucket8(this.$NotificationGenericBucket1.sec_to_evict_read);return{secToEvict:j,firstTime:i.first_read_time||0,currentTime:Date.now()/1e3}};h.prototype.$NotificationGenericBucket18=function(i){var j=i.secToEvict,k=i.firstTime,l=i.currentTime;return j===-1||k===0?true:l-k<j};h.prototype.$NotificationGenericBucket14=function(i){return this.$NotificationGenericBucket18(this.$NotificationGenericBucket15(i))};h.prototype.$NotificationGenericBucket16=function(i){return this.$NotificationGenericBucket18(this.$NotificationGenericBucket17(i))};h.prototype.$NotificationGenericBucket19=function(i){return true};f.exports=h}),null);
__d("NotificationServerTransport",["invariant","DOM","UIPagelet","compactArray","ifRequired","normalizeNotificationUpdatePayload","objectValues","once","promiseFinally","setImmediateAcrossTransitions","uniqueID"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i={},j={},k={},l={};function m(w){if(l[w]==null){l[w]=c("DOM").create("div",{"class":"hidden_elem",id:w});c("DOM").appendContent(document.documentElement,l[w])}return l[w].id}function n(w){return w.reduce(function(x,y){var z=y.targetNumToLoad;return Math.max(x,z)},0)}function o(w,x,y,z){var A=i[x];if(!A||A.clientRequestID!==w)return;A.calls.forEach(function(B){var C=B.onError;if(C)C(z)})}function p(w,x){__p&&__p();var y=x.getHash(),z=i[y];if(!z||z.clientRequestID!==w)return;delete i[y];z.calls.forEach(function(A){var B=A.onCompleted;if(B)B()});if(j[y]!=null)q(x)}function q(w){__p&&__p();var x=w.getHash();if(k[x]!=null)return;k[x]=c("setImmediateAcrossTransitions")(function(){__p&&__p();delete k[x];var y=c("uniqueID")(),z=j[x];delete j[x];if(z==null)return;var A=n(z),B=w.getRequestParams(A);if(B.length<=0){z.forEach(function(F){var G=F.onCompleted;if(G)G()});return}var C=o.bind(this,y,x,w),D=w.getStreamingTransportPageletName();D!=null||h(0);var E=c("UIPagelet").loadFromEndpoint(D,m(y),babelHelpers["extends"]({},B,{clientRequestID:y}),{allowIrrelevantRequests:true,automatic:false,crossPage:true,errorHandler:C,jsNonblock:true,transportErrorHandler:C,usePipe:true,usePostRequest:false});i[x]={calls:z,clientRequestID:y,endpointState:w,transport:E}}.bind(this))}var r={makeRequest:function w(x,y,z){__p&&__p();var A=z.onChunkResponse,B=z.onCompleted,C=z.onError,D=x.getHash(),E={onChunkResponse:A,onCompleted:B,onError:C,targetNumToLoad:y};v(D);var F=i[D],G=F?n(F.calls)>=y:false;if(G){F!=null||h(0);F.calls.push(E)}else{if(j[D]==null)j[D]=[];j[D].push(E);if(F==null)q(x)}return{remove:function H(){__p&&__p();var F=i[D];if(F!=null){var I=F.calls.indexOf(E);if(I!==-1)F.calls.splice(I,1);if(F.calls.length===0){if(F.transport)F.transport.abandon();delete i[D];if(j[D]!=null)q(x)}}var J=j[D];if(J!=null){var K=J.indexOf(E);if(K!==-1)J.splice(K,1)}}}},handleResponseChunk:function w(x,y){var z=s(x);z.forEach(function(A){A(c("normalizeNotificationUpdatePayload")(y))})},handleRequestCompleted:function w(x){var y=c("objectValues")(i).find(function(y){return y&&y.clientRequestID===x});y||h(0);p(x,y.endpointState)}};function s(w){__p&&__p();var x=Object.keys(i).find(function(B){var C=i[B];return C&&C.clientRequestID===w}),y=x&&i[x];if(!y||!x)return[];var z=y.calls,A=j[x];if(A)z=z.concat(A);return c("compactArray")(z.map(function(B){return B.onChunkResponse}))}function t(w,x){__p&&__p();var y=x.targetNumToLoad,z=x.endpointState,A=x.payloadPromise;if(i[w]!=null)return;var B=c("uniqueID")(),C={calls:[{targetNumToLoad:y}],clientRequestID:B,endpointState:z};i[w]=C;A||h(0);var D=A.then(function(E){var F=s(B);F.forEach(function(G){G(E)})});c("promiseFinally")(D,function(){p(B,z)}).done()}var u=function u(w){c("ifRequired")("NotificationEagerLoader",function(x){var y=x.eagerlyLoadedData;if(y.hasData&&w===y.endpointState.getHash())t(w,y)})},v=c("once")(u);f.exports=r}),null);
__d("NotificationServerTransportLegacy",["AsyncRequest","normalizeNotificationUpdatePayload"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={makeRequest:function i(j,k,l){__p&&__p();var m=l.onError,n=l.onChunkResponse,o=l.onCompleted,p=true;function q(u){if(!p)return;var v=c("normalizeNotificationUpdatePayload")(u.getPayload());try{n(v)}finally{o()}}function r(u){if(!p)return;if(m)m(u)}var s=j.getRequestParams(k);if(s.length<=0){o();return{remove:function u(){}}}var t=new(c("AsyncRequest"))(j.endpointURI).setAllowCrossPageTransition(true).setData(s).setErrorHandler(r).setTransportErrorHandler(r).setHandler(q);t.send();return{remove:function u(){p=false;t.abandon()}}}};f.exports=h}),null);
__d("sortBy",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j){__p&&__p();var k=i.map(function(l,m){return{index:m,sortValue:j(l),value:l}});k.sort(function(l,m){var n=l.sortValue,o=m.sortValue;if(n>o)return 1;if(n<o)return-1;return l.index-m.index});return k.map(function(l){return l.value})}f.exports=h}),null);
__d("NotificationStore",["ErrorUtils","NotificationConstants","NotificationEndpointState","NotificationListConfig","NotificationsDefaultEndpointURI","NotificationServerTransport","NotificationServerTransportLegacy","NotificationUpdates","QE2Logger","createObjectBy","distinctArrayBy","flatMapArray","objectValues","sortBy","sprintf"],(function a(b,c,d,e,f,g){__p&&__p();var h={};function i(n,o,p){return n.page_info!=null&&o.classification==p.classification&&o.endpointURI===p.endpointURI&&o.readness==p.readness}function j(n,o){__p&&__p();var p={};c("NotificationEndpointState").getAllInstances(o.endpointURI).forEach(function(q){__p&&__p();var r=void 0;if(i(n,q,o)){q.graphQLPageInfo=n.page_info;r=n}else if(n.payloadsource===c("NotificationConstants").PayloadSourceType.SYNC&&o.endpointURI===c("NotificationsDefaultEndpointURI")&&q.classification==null&&q.readness==null)r=n;else r=babelHelpers["extends"]({},n,{nodes:n.nodes?n.nodes.filter(function(t){return k(t,q)}):undefined});if(r.nodes&&r.nodes.length>0){var s=l(q,r);if(s!=null)s.forEach(function(t){p[t]=true})}});c("NotificationUpdates").didUpdateNotifications(Object.keys(p))}function k(n,o){__p&&__p();var p=o.classification,q=o.notifications,r=o.order,s=o.readness,t=r.getAllResources();t.length===0;if(t.length>0){var u=t[0],v=q.getResource(u);if(v.creation_time>=n.creation_time)return false}if(p&&(!n.classifications||!n.classifications.includes(p)))return false;if(s&&s==="SEEN_AND_READ"!==(n.seen_state==="SEEN_AND_READ"))return false;return true}function l(n,o){__p&&__p();var p=[],q={};if(o.nodes&&o.nodes.length>0)o.nodes.forEach(function(r){var s=r.alert_id,t=n.notifications.getResource(s);if(!t||t.creation_time<r.creation_time){p.push(s);q[s]=r}});n.notifications.addResourcesAndExecute(q);n.order.addResources(p);return p}c("NotificationUpdates").subscribe("update-notifications",function(n,o){if(o.payloadsource!==c("NotificationConstants").PayloadSourceType.ENDPOINT)j(o,{endpointURI:o.endpoint!=null?o.endpoint:c("NotificationsDefaultEndpointURI")})});var m={getNotifications:function n(o,p,q){__p&&__p();var r=c("NotificationEndpointState").getInstance(p),s=r.notifications,t=r.order,u=void 0,v=t.executeOrEnqueue(0,o,function(E){if(q){u=s.executeOrEnqueue(E,q);var F=s.getUnavailableResources(u);if(F.length>0)c("ErrorUtils").reportError(new Error(c("sprintf")("The range for this endpoint contained notification IDs for which we have no payload (Notification IDs: `%s`. Endpoint config: `%s`).",JSON.stringify(F),JSON.stringify(r.getConfig()))))}});function w(){t.unsubscribe(v);if(u)s.unsubscribe(u)}if(t.getUnavailableResources(v).length===0)return{remove:w};if(!m.canFetchMore(p)){t.forceRunCallbacks();return{remove:w}}var x=r.getHash();if(h[x]==null)h[x]=1;else h[x]++;function y(){h[x]--;if(h[x]===0)t.forceRunCallbacks()}function z(E){if(!(E&&E.nodes))return;c("NotificationUpdates").handleUpdate(c("NotificationConstants").PayloadSourceType.ENDPOINT,E,p.readness,p.classification);j(babelHelpers["extends"]({},E,{payloadsource:c("NotificationConstants").PayloadSourceType.ENDPOINT}),p)}function A(){h[x]--;if(h[x]===0)t.forceRunCallbacks()}var B=void 0;if(c("NotificationListConfig").useStreamingTransport&&r.getStreamingTransportPageletName()!=null)B=c("NotificationServerTransport");else B=c("NotificationServerTransportLegacy");if(p.endpointURI===c("NotificationsDefaultEndpointURI"))c("QE2Logger").logExposureForUser("www_notifications_perf_h2_2017");var C=B.makeRequest(r,o,{onChunkResponse:z,onCompleted:A,onError:y}),D=C.remove;return{remove:function E(){w();D()}}},getNotification:function n(o){var p=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],q=p.classification,r=p.endpointURI,s=r===undefined?c("NotificationsDefaultEndpointURI"):r,t=p.readness,u=c("NotificationEndpointState").getInstance({classification:q,endpointURI:s,readness:t}),v=u.notifications;return v.getResource(o)},getAllForAllEndpoints:function n(){var o=c("NotificationEndpointState").getAllInstances(),p=c("flatMapArray")(o,function(t){var u=this.getAll(t.getConfig());return c("objectValues")(u)}.bind(this)),q=c("sortBy")(p,function(t){return t.creation_time}),r=q.reverse(),s=c("distinctArrayBy")(r,function(t){return t.alert_id});return c("createObjectBy")(s,function(t){return t.alert_id})},getAll:function n(o){var p=c("NotificationEndpointState").getInstance(o),q=p.notifications,r=p.order,s={};r.getAllResources().forEach(function(t){var u=q.getResource(t);if(u==null)c("ErrorUtils").reportError(new Error(c("sprintf")("The range for this endpoint contained a notification ID for which we have no payload (Notification ID: `%s`. Endpoint config: `%s`).",t,JSON.stringify(o))));else s[t]=u});return s},getCount:function n(o){var p=c("NotificationEndpointState").getInstance(o);return p.order.getAllResources().length},canFetchMore:function n(o){var p=c("NotificationEndpointState").getInstance(o),q=p.graphQLPageInfo;return!q||!Object.prototype.hasOwnProperty.call(q,"has_next_page")||q.has_next_page},registerEndpoint:function n(o){c("NotificationEndpointState").getInstance(o)}};m.registerEndpoint({endpointURI:c("NotificationsDefaultEndpointURI")});f.exports=m}),null);
__d("NotificationBucketStore",["Arbiter","Banzai","JSLogger","NotificationConstants","NotificationGenericBucket","NotificationsBucketList","NotificationsDefaultEndpointURI","NotificationStore","NotificationUpdates"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("NotificationConstants").PayloadSourceType,i=[],j={},k={},l=[],m=false,n={},o={},p="notif_jewel_buckets",q=function q(){if(m)return;m=true;c("NotificationsBucketList").buckets.forEach(function(D){D.bucket_type=D.bucket_type.toUpperCase();var E=new(c("NotificationGenericBucket"))(D);i.push(E);j[E.getType()]=E});A()},r=function r(){l=i.map(function(D){return{ids:D.getSortedIDs(),title:D.getTitle()||"",bucketType:D.getType()}})},s=function s(D){__p&&__p();var E=D.alert_id;if(!n[E])n[E]=[];var F=[];for(var G=0,H=i.length;G<H;G++){var I=i[G],J=I.insertIfEligible(D);F.push({bucket:I.getType(),result:J});if(J.eligible){n[E].push(F);u(D,I);return I.getType()}}n[E].push(F);return null},t=function t(D,E){var F="PRIORITY_INBOX";if(!j[F]||E.getType()===F)return;var G=D.alert_id;if(o[G]||D.creation_time>Date.now()/1e3-60*60){var H=n[G],I=H[H.length-1]||[],J={notif_data:{alert_id:D.alert_id.split(":")[1],creation_time:D.creation_time,eligible_buckets:D.eligible_buckets,first_seen_time:D.first_seen_time,notif_type:D.notif_type,seen_state:D.seen_state,sort_keys:D.sort_keys},eviction_data:I,was_live_send:o[G]===true,priority_eviction_reason:I[0]?I[0].result.type:null};c("Banzai").post(p,{event_type:"bucketing_error",data:J})}},u=function u(D,E){k[D.alert_id]=E.getType();t(D,E)},v=function v(D,E){delete k[D.alert_id]},w=function w(D){var E=D.alert_id,F=x(E);if(F){var G=y(F);if(G){G.remove(E);v(D,G)}}s(D)},x=function x(D){return k[D]},y=function y(D){return j[D]},z=function z(){k={};i.forEach(function(D){return D.reset()});n={};r()},A=function A(){var D=c("NotificationStore").getAll({endpointURI:c("NotificationsDefaultEndpointURI")});B(Object.keys(D).map(function(E){return D[E]}))},B=function B(D){D.forEach(w);r()};c("NotificationUpdates").subscribe("update-notifications",function(D,E){__p&&__p();if(!E.nodes||E.nodes.length===0)return;if(E.payloadsource===h.LIVE_SEND){E.nodes.forEach(function(F){return o[F.alert_id]=true});z();A()}else if(E.nodes){E.nodes.forEach(function(F){return o[F.alert_id]=false});B(E.nodes)}});c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(D,E){E.notifs_bucket_data={bucketInfo:l,data:l.reduce(function(F,E){var G=E.ids.map(function(H){return{id:H,results:n[H]}});return[].concat(F,G)},[])}});q();var C={getBucketListData:function D(){return l},isEmptyBucketListData:function D(){var E=l.reduce(function(F,G){return F+G.ids.length},0);return E===0}};f.exports=C}),null);
__d("NotificationHiddenState",["NotificationConstants","NotificationUpdates","isEmpty"],(function a(b,c,d,e,f,g){__p&&__p();var h={};c("NotificationUpdates").subscribe("update-notifications",function(j,k){__p&&__p();var l,m=k.nodes,n=k.payloadsource;if(n===c("NotificationConstants").PayloadSourceType.LIVE_SEND&&m&&m.length)(function(){var o={};m.forEach(function(p){var q=p.alert_id;if(h[q])o[q]=false});if(!c("isEmpty")(o)){h=Object.assign(h,o);c("NotificationUpdates").didUpdateHiddenState(Object.keys(o))}})()});c("NotificationUpdates").subscribe("update-hidden",function(j,k){if(k.hiddenState){var l=k.hiddenState;h=Object.assign(h,l);c("NotificationUpdates").didUpdateHiddenState(Object.keys(l))}});var i={isHidden:function j(k){if(h[k])return h[k];return false}};f.exports=i}),null);
__d("NotificationVPVs",["MarauderLogger","Set","getElementRect"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=new(c("Set"))();function i(o){if(j(o))return;c("MarauderLogger").log("notifications_vpv",undefined,null,"notification",o);h.add(o)}function j(o){return h.has(o)}function k(){h.clear()}function l(o,p){if(!o||!p)return false;return!(o.bottom<p.top||o.top>p.bottom||o.right<p.left||o.left>p.right)}function m(o){var p=c("getElementRect")(o);if(!p||p.top==0&&p.bottom==0&&p.left==0&&p.right==0)return null;return p}var n={logImpression:i,clearImpressions:k,hasLoggedImpression:j,getValidatedRectangle:m,areRectsOverlapping:l};f.exports=n}),null);
__d("NotificationList.react",["Arbiter","FunnelLogger","NotificationBucketStore","NotificationConstants","NotificationHiddenState","NotificationJewelFunnelLoggingConstants","NotificationListConfig","NotificationsDefaultEndpointURI","NotificationSeenState","NotificationStore","NotificationUpdates","NotificationUserActions","NotificationVPVs","NotifType","React","SubscriptionsHandler","TimeSlice","getObjectValues","isEmpty","mapObject"],(function a(b,c,d,e,f,g){__p&&__p();var h,i,j=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_NAME,k=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,l=c("React").PropTypes,m=c("NotificationConstants").PayloadSourceType.LIVE_SEND,n="notification_clicked";function o(q){return{classification:q.classification,endpointURI:q.endpoint!=null?q.endpoint:c("NotificationsDefaultEndpointURI"),readness:q.readness}}h=babelHelpers.inherits(p,c("React").Component);i=h&&h.prototype;function p(q){__p&&__p();var r;"use strict";for(var s=arguments.length,t=Array(s>1?s-1:0),u=1;u<s;u++)t[u-1]=arguments[u];(r=i.constructor).call.apply(r,[this,q].concat(t));this.$NotificationList1={};this.$NotificationList2=false;this.$NotificationList3=new(c("SubscriptionsHandler"))();this.$NotificationList4=0;this.$NotificationList9=function(){var x={};Object.keys(this.$NotificationList1).forEach(function(y){var z=c("NotificationHiddenState").isHidden(y);if(z!=this.state.hiddenState[y])x[y]=z}.bind(this));if(!c("isEmpty")(x))this.setState({hiddenState:babelHelpers["extends"]({},this.state.hiddenState,x)});this.$NotificationList1={};this.$NotificationList8(c("NotificationStore").getCount(o(this.props)))}.bind(this);this.$NotificationList11=function(x,y,z){if(this.state.currentlyFetching||!this.state.canFetchMore)return;if(x){c("FunnelLogger").appendAction(j,k.FETCH_NEXT_SET);this.$NotificationList10()}this.$NotificationList12(y,z)}.bind(this);this.$NotificationList13=function(){this.setState({showingChevron:true})}.bind(this);this.$NotificationList14=function(){this.setState({showingChevron:false})}.bind(this);this.$NotificationList17=function(x){c("Arbiter").inform(n,{endpointConfig:o(this.props),alertID:x})}.bind(this);this.$NotificationList18=function(x){if(this.props.paused&&this.props.readness==="UNREAD"){var y=babelHelpers["extends"]({},this.state.readWhilePausedOrNavigating);y[x]=true;this.setState({readWhilePausedOrNavigating:y})}}.bind(this);this.$NotificationList19=function(x){this.$NotificationList4=x}.bind(this);var v=o(q);c("NotificationStore").registerEndpoint(v);var w=c("NotificationStore").getAll(v);this.state={currentlyFetching:false,canFetchMore:c("NotificationStore").canFetchMore(v),notifs:w,hiddenState:c("mapObject")(w,function(x,y){return c("NotificationHiddenState").isHidden(y)}),readState:c("mapObject")(w,function(x,y){return c("NotificationSeenState").isRead(y)}),showingChevron:false,readWhilePausedOrNavigating:{}}}p.prototype.componentWillMount=function(){"use strict";__p&&__p();c("FunnelLogger").appendAction(j,k.FETCH_NOTIFICATIONS);this.$NotificationList3.addSubscriptions(c("NotificationUpdates").subscribe("notifications-updated",function(q,r){if(r.source==m&&!c("isEmpty")(r.updates)){this.$NotificationList2=true;var s=this.props.paused;if(s){this.$NotificationList1=babelHelpers["extends"]({},this.$NotificationList1,r.updates);return}}this.$NotificationList5(c("NotificationStore").getAll(o(this.props)))}.bind(this)),c("NotificationUpdates").subscribe(["hidden-state-updated","read-state-updated"],function(q,r){__p&&__p();if(q=="hidden-state-updated"){if(r.source!==m||!this.props.paused){var s=c("mapObject")(r.updates,function(u,v){return c("NotificationHiddenState").isHidden(v)});this.setState({hiddenState:babelHelpers["extends"]({},this.state.hiddenState,s)})}}else{var t=c("mapObject")(r.updates,function(u,v){return c("NotificationSeenState").isRead(v)});this.setState({readState:babelHelpers["extends"]({},this.state.readState,t)})}}.bind(this)))};p.prototype.componentWillUnmount=function(){"use strict";this.$NotificationList3.release()};p.prototype.componentWillReceiveProps=function(q){"use strict";if(!this.$NotificationList6(q)&&q.paused)return;if(this.props.enableHubView&&this.props.readness==="UNREAD")return;this.setState({readWhilePausedOrNavigating:{}})};p.prototype.$NotificationList6=function(q){"use strict";return q.classification!==this.props.classification||q.readness!==this.props.readness};p.prototype.$NotificationList7=function(q){"use strict";__p&&__p();var r=Object.keys(this.state.notifs),s=Object.keys(q).filter(function(u){return!this.state.notifs[u]}.bind(this));r=r.concat(s);var t={};r.forEach(function(u){if(this.$NotificationList1[u]){if(this.state.notifs[u])t[u]=this.state.notifs[u]}else t[u]=q[u]||this.state.notifs[u]}.bind(this));return t};p.prototype.$NotificationList5=function(q){"use strict";var r=c("isEmpty")(this.$NotificationList1)?q:this.$NotificationList7(q),s={},t={};c("getObjectValues")(r).forEach(function(v){var w=v.alert_id;s[w]=c("NotificationSeenState").isRead(w);t[w]=c("NotificationHiddenState").isHidden(w)});var u=o(this.props);this.setState({notifs:r,canFetchMore:c("NotificationStore").canFetchMore(u)||c("NotificationStore").getCount(u)!==Object.keys(r).length,readState:babelHelpers["extends"]({},this.state.readState,s),hiddenState:babelHelpers["extends"]({},this.state.hiddenState,t)})};p.prototype.$NotificationList8=function(q){"use strict";this.setState({currentlyFetching:true});this.$NotificationList3.addSubscriptions(c("NotificationStore").getNotifications(q,o(this.props),function(r){this.setState({currentlyFetching:false});this.$NotificationList5(r)}.bind(this)))};p.prototype.$NotificationList10=function(){"use strict";if(!this.state.currentlyFetching){var q=Object.keys(this.state.notifs).length;this.$NotificationList8(q+this.props.numPerPage)}};p.prototype.$NotificationList12=function(q,r){"use strict";__p&&__p();if(!q||!r)return;for(var s=0,t=q.children.length;s<t;s++){var u=q.children[s];if(u){var v=u.getAttribute("data-alert-id");if(v&&!c("NotificationVPVs").hasLoggedImpression(v)){var w=c("NotificationVPVs").getValidatedRectangle(u);if(w&&c("NotificationVPVs").areRectsOverlapping(r,w))c("NotificationVPVs").logImpression(v)}}}};p.prototype.$NotificationList15=function(q){"use strict";if(c("NotificationListConfig").requestFullViewportOfNotificationsOnFirstOpen){var r=Math.max(this.props.numPerPage,Math.ceil(this.$NotificationList4));if(r>0)this.$NotificationList8(r)}else if(q.length>this.props.numPerPage)this.$NotificationList8(q.length);else this.$NotificationList10()};p.prototype.$NotificationList16=function(q){"use strict";__p&&__p();var r=c("NotificationSeenState").getUnseenIDs();if(!c("isEmpty")(this.$NotificationList1))r=r.filter(function(s){return!this.$NotificationList1[s]}.bind(this));if(r.length&&(this.props.paused||this.props.enableHubView))c("TimeSlice").guard(function(){return c("NotificationUserActions").markNotificationsAsSeen(r)},"NotificationList _populateList markNotificationsAsSeen",{propagationType:c("TimeSlice").PropagationType.ORPHAN})();if(this.props.hasEverBeenOpened)if(!q||!q.hasEverBeenOpened)this.$NotificationList15(r)};p.isReaction=function(q){"use strict";return q===c("NotifType").LIKE||q===c("NotifType").OPEN_GRAPH_ACTION_LIKE||q===c("NotifType").LIKE_TAGGED||q===c("NotifType").PAGE_FAN||q===c("NotifType").IG_MEDIA_LIKE||q===c("NotifType").FEEDBACK_REACTION_GENERIC||q===c("NotifType").FEEDBACK_REACTION_GENERIC_TAGGED||q===c("NotifType").MESSENGER_REACTIONS};p.prototype.componentDidUpdate=function(q){__p&&__p();var r,s=this,t;"use strict";this.$NotificationList16(q);if(q.paused&&!this.props.paused){var r=function(){s.$NotificationList2=false;var u=setTimeout(s.$NotificationList9,0);s.$NotificationList3.addSubscriptions({remove:function v(){clearTimeout(u)}});return{v:void 0}}();if(typeof r==="object")return r.v}if(this.props.paused&&this.$NotificationList6(q)){var t=function(){var u=setTimeout(s.$NotificationList9,0);s.$NotificationList3.addSubscriptions({remove:function v(){clearTimeout(u)}});return{v:void 0}}();if(typeof t==="object")return t.v}};p.prototype.componentDidMount=function(){"use strict";this.$NotificationList16()};p.prototype.render=function(){__p&&__p();var q;"use strict";var r=this.props.listRenderer,s=this.state,t=s.notifs,u=s.readState,v=s.readWhilePausedOrNavigating,w={};if(this.props.readness==null)w=t;else Object.keys(t).forEach(function(z){var A=t[z],B=A.alert_id,C=u[B];if(this.props.readness==="UNREAD")C=!C||Object.prototype.hasOwnProperty.call(v,B);if(C)w[B]=A}.bind(this));if(this.props.hideReactions)(function(){var z={};Object.keys(w).forEach(function(A){var B=t[A];if(!p.isReaction(B.notif_type))z[B.alert_id]=B});w=z})();var x=this.props.classification;if(x)Object.keys(t).forEach(function(z){var A=t[z];if(!A.classifications||!A.classifications.includes(x))delete w[A.alert_id]});var y=!c("NotificationBucketStore").isEmptyBucketListData()?c("NotificationBucketStore").getBucketListData():null;return c("React").createElement(r,{paused:this.props.paused,tracking:this.props.tracking,shortenTimestamp:this.props.shortenTimestamp,maxHeight:this.props.maxHeight,useChevron:this.props.useChevron,chevronType:this.props.chevronType,buckets:y,notifs:w,afterScroll:this.$NotificationList11,onChevronShow:this.$NotificationList13,onChevronHide:this.$NotificationList14,currentlyFetching:this.state.currentlyFetching,canFetchMore:this.state.canFetchMore,hiddenState:this.state.hiddenState,readState:this.state.readState,showingChevron:this.state.showingChevron,shouldScroll:this.$NotificationList2,upsell:this.props.upsell||null,isRHC:this.props.isRHC,enableMarkUnread:this.props.enableMarkUnread,onClick:this.$NotificationList17,onRead:this.$NotificationList18,onNumNotificationsViewableChange:this.$NotificationList19})};p.propTypes={hasEverBeenOpened:l.bool,enableHubView:l.bool,enableMarkUnread:l.bool,maxHeight:l.number,paused:l.bool,tracking:l.string,useChevron:l.bool,chevronType:l.string,numPerPage:l.number.isRequired,listRenderer:l.func.isRequired,upsell:l.object,endpoint:l.string,readness:l.string,classification:l.string};f.exports=p}),null);
__d("NotificationListDelightUtils",["RelationshipDelightUtils"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=-1,i={canShowHeartDelight:function j(k,l,m){if(l)return false;if(!c("RelationshipDelightUtils").shouldHeartNotification(k))return false;if(h<0||h>m)h=m;return true},getFirstDelightRow:function j(){return h}};f.exports=i}),null);
__d("NotificationListDelights.react",["cx","BootloadedComponent.react","JSResource","NotificationListDelightUtils","NotificationSeenState","React","RelationshipDelightUtils"],(function a(b,c,d,e,f,g,h){"use strict";var i=-1;function j(k){var l=k.rowIndex,m=k.notification,n=m.alert_id,o=c("NotificationListDelightUtils").getFirstDelightRow()===l&&!c("NotificationSeenState").isSeen(n)?1:2;c("RelationshipDelightUtils").logNotificationAnimation(n,o,l);return c("React").createElement("div",{className:"_3u5l _3u5m"},c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("RelationshipDelightsActorAnimation.react").__setRef("NotificationListDelights.react"),animationPhase:o}))}f.exports=j}),null);
__d("NotificationListItem.react",["cx","Bootloader","Event","Keys","Link.react","NotificationListConfig","NotificationListDelights.react","NotificationListDelightUtils","NotificationListItemBaseModule","NotificationListRendererUtils","NotificationURI","NotificationUserActions","PageTransitions","React","URI"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("NotificationListItemBaseModule").NotificationListItemBase;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$NotificationListItem5=function(r){__p&&__p();var s,t=this.props.notification,u=t.primerAttributes,v=t.url;if(u&&u.ajaxify)(function(){var z=new(c("URI"))(u.ajaxify),A=z.getQueryData(),B=A.app_id,C=A.page_id,D=A.post_id,E=A.ref;if(E==="aymt_auto_opened_dialog")c("Bootloader").loadModules(["BoostedComponentAYMTActionsV2"],function(F){F.aymtAutoOpenDialogLinkClick(B,C,D,E)},"NotificationListItem.react")})();else if(v){var w=new(c("URI"))(v),x=w.getQueryData(),y=x.aymt_tip;if(y==="1")c("PageTransitions").go(w.addQueryData("aymt_link_click",Date.now()))}}.bind(this),this.$NotificationListItem6=function(r){this.props.onClick&&this.props.onClick(this.$NotificationListItem4());this.$NotificationListItem7(r);c("NotificationListRendererUtils").openNotification(r,this.props.notification)}.bind(this),this.$NotificationListItem8=function(r){if(c("Event").getKeyCode(r.nativeEvent)==c("Keys").RETURN){var s=this.$NotificationListItem4();this.props.onSelected&&this.props.onSelected(s);this.$NotificationListItem7(r)}}.bind(this),this.$NotificationListItem7=function(r){var s=this.$NotificationListItem4();if(this.props.onRead&&r)this.props.onRead(s);c("NotificationUserActions").markNotificationsAsRead([s],null)}.bind(this),this.$NotificationListItem9=function(){var r=this.$NotificationListItem4();c("NotificationUserActions").markNotificationsAsUnread([r],null)}.bind(this),this.$NotificationListItem11=function(r){var s=void 0;if(!c("NotificationListRendererUtils").isStoryOnlyLiveVideoNotification(this.props.notification))s=c("NotificationURI").localize(new(c("URI"))(this.props.notification.url));return c("React").createElement("a",babelHelpers["extends"]({},this.props.notification.primerAttributes,{href:s,role:"button",tabIndex:0,className:"_33e _1_0e",onClick:this.$NotificationListItem5,onClickCapture:this.$NotificationListItem6,onKeyUp:this.$NotificationListItem8}),r,this.$NotificationListItem10())}.bind(this),n}l.prototype.$NotificationListItem2=function(){return c("NotificationListConfig").canMarkUnread||(this.props.enableHubView||false)&&c("NotificationListConfig").canMarkUnreadInHub};l.prototype.$NotificationListItem3=function(){var m=this.props,n=m.notification,o=m.isRead,p=m.rowIndex;return c("NotificationListDelightUtils").canShowHeartDelight(n,o,p)};l.prototype.$NotificationListItem4=function(){return this.props.notification.alert_id};l.prototype.$NotificationListItem10=function(){if(!this.$NotificationListItem3()||!this.props.paused)return null;return c("React").createElement(c("NotificationListDelights.react"),{notification:this.props.notification,rowIndex:this.props.rowIndex})};l.prototype.render=function(){return c("React").createElement(k,babelHelpers["extends"]({},this.props,{canMarkUnread:this.$NotificationListItem2(),hasCustomForeground:this.$NotificationListItem3(),renderLink:this.$NotificationListItem11,onMarkItemRead:this.$NotificationListItem7,onMarkItemUnread:this.$NotificationListItem9,hideIcon:false}))};f.exports=l}),null);
__d("NotificationListPropTypes",["React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").PropTypes,i={tracking:h.string,notifs:h.object,afterScroll:h.func,onChevronShow:h.func,onChevronHide:h.func,onRead:h.func,canFetchMore:h.bool,hiddenState:h.object,readState:h.object,showingChevron:h.bool,paused:h.bool,maxHeight:h.number,shouldScroll:h.bool,listItemRenderer:h.func};f.exports=i}),null);
__d("NotificationPageList.react",["cx","fbt","ErrorBoundary.react","Event","LoadingIndicator.react","LogicalGrid.react","NotificationListItem.react","NotificationListPropTypes","NotifTestIDs","React","ReactDOM","Vector","debounce","getObjectValues","getViewportDimensions","isEmpty"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(){__p&&__p();var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.$NotificationPageList5=function(){var r=c("ReactDOM").findDOMNode(this.$NotificationPageList2),s=this.$NotificationPageList4();if(this.props.afterScroll)this.props.afterScroll(this.$NotificationPageList3(),r,s)}.bind(this),this.$NotificationPageList7=function(){return c("getObjectValues")(this.props.notifs).map(function(r){return JSON.stringify(r)})}.bind(this),n}l.prototype.$NotificationPageList3=function(){"use strict";if(!this.$NotificationPageList1)return false;var m=c("ReactDOM").findDOMNode(this.$NotificationPageList1);if(!m)return false;var n=c("Vector").getElementPosition(m,"viewport").y;return n<c("Vector").getViewportDimensions().y};l.prototype.$NotificationPageList4=function(){"use strict";var m=c("getViewportDimensions").withoutScrollbars();return{top:0,bottom:m.height,left:0,right:m.width}};l.prototype.$NotificationPageList6=function(m,n){"use strict";return n.indexOf(m)};l.prototype.componentDidUpdate=function(){"use strict";this.$NotificationPageList5()};l.prototype.componentDidMount=function(){"use strict";c("Event").listen(window,"scroll",c("debounce")(this.$NotificationPageList5,200));this.$NotificationPageList5()};l.prototype.$NotificationPageList8=function(){"use strict";var m=c("getObjectValues")(this.props.notifs).map(function(o){return o.alert_id}),n=this.props.listItemRenderer;return c("getObjectValues")(this.props.notifs).map(function(o,p){var q=o.alert_id,r=this.$NotificationPageList6(q,m);return c("React").createElement(c("ErrorBoundary.react"),{key:q},c("React").createElement(n,{getDebugData:this.$NotificationPageList7,enableMarkUnread:this.props.enableMarkUnread,isNotifsPage:true,isRead:this.props.readState[q],isSelected:this.props.selectedID===q,noPhotoPreviews:true,notification:o,onRead:this.props.onRead,onChevronHide:this.props.onChevronHide,onChevronShow:this.props.onChevronShow,paused:!!this.props.paused,row:r,rowIndex:p,shortenTimestamp:this.props.shortenTimestamp,visible:!this.props.hiddenState[q]}))}.bind(this))};l.prototype.render=function(){"use strict";__p&&__p();var m=null,n=null,o=c("React").createElement("ul",{"data-gt":this.props.tracking,"data-testid":c("NotifTestIDs").SEE_ALL_LIST});if(!c("isEmpty")(this.props.notifs))m=c("React").createElement(c("LogicalGrid.react"),{ref:function(s){return this.$NotificationPageList2=s}.bind(this),component:o},this.$NotificationPageList8());else if(!this.props.canFetchMore)m=c("React").createElement("div",{className:"_44_s","data-testid":c("NotifTestIDs").SEE_ALL_LIST},i._("\u0644\u0627 \u062a\u0648\u062c\u062f \u0625\u0634\u0639\u0627\u0631\u0627\u062a \u062c\u062f\u064a\u062f\u0629"));if(this.props.canFetchMore)n=c("React").createElement(c("LoadingIndicator.react"),{color:"white",size:"large",ref:function(s){return this.$NotificationPageList1=s}.bind(this),className:"_44_t"});var p=null;if(this.props.upsell){var q=this.props.upsell.module;p=c("React").createElement(q,babelHelpers["extends"]({isPage:true},this.props.upsell.props))}var r="_44_u"+(this.props.showingChevron?" _44_v":"");return c("React").createElement("div",{className:r},p,m,n)};l.propTypes=c("NotificationListPropTypes");l.defaultProps={listItemRenderer:c("NotificationListItem.react")};f.exports=l}),null);
__d("DeprecatedCSSMiscellany",["$","ge","CSS"],(function a(b,c,d,e,f,g){__p&&__p();function h(){for(var m=0;m<arguments.length;m++){var n=c("ge")(arguments[m]);if(n)c("CSS").show(n)}return false}function i(){for(var m=0;m<arguments.length;m++){var n=c("ge")(arguments[m]);if(n)c("CSS").hide(n)}return false}function j(m){m=c("ge")(m);if(m)return c("CSS").shown(m);else return false}function k(){for(var m=0;m<arguments.length;m++){var n=c("$")(arguments[m]);if(n)c("CSS").toggle(n)}return false}function l(){for(var m=0;m<arguments.length;m++){var n=c("$")(arguments[m]);if(n)c("CSS").toggle(n)}return false}f.exports={show:h,hide:i,shown:j,toggle:k,toggleDisplayNone:l}}),null);
__d("MobileSmsActivationController",["AsyncRequest","AsyncResponse","Dialog","goURI","ge","ReloadPage","$","DeprecatedCSSMiscellany"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("DeprecatedCSSMiscellany").hide,i=c("DeprecatedCSSMiscellany").show;function j(k,l,m,n,o,p){Object.assign(this,{profile_id:k,parent:parent,source:l,misc:m,carrier:null,AJAX_URI:"/ajax/mobile/activation.php",redirect_uri:null,cb_obj:n,status_id:p||"mobile_throbber"});if(o)this.goVerification();else this.start();j.instance=this}j.instance={};j.getInstance=function(){return j.instance};j.show_carriers=function(){var k=c("$")("selected_country").value,l=c("$")("carrier_country").value;if(k)h(c("$")(k+"_carrier_select"));c("$")("selected_country").value=l;c("$")("selected_carrier").value=0;i(c("$")(l+"_carrier_select"))};j.update_carrier=function(){var k=c("$")("selected_country").value+"_carrier_select";c("$")("selected_carrier").value=c("$")(k).value};Object.assign(j.prototype,{goStep:function k(l){if(l==2){this.getShortCode();return}else if(l==3){this.getConfirmCode();return}this.start()},start:function k(l){new(c("AsyncRequest"))().setURI(this.AJAX_URI).setData({profile_id:this.profile_id,get_carriers:1,source:this.source,misc:this.misc,error:l}).setHandler(this.showCarriers.bind(this)).setStatusElement(c("$")(this.status_id)).send()},showCarriers:function k(l){var m=l.getPayload();if(!m)return;if(this.cb_obj&&this.cb_obj.onShowCarriers)this.cb_obj.onShowCarriers(m);else new(c("Dialog"))().setTitle(m.title).setBody(m.html).setHandler(this.getShortCode.bind(this)).setButtons([c("Dialog").NEXT,c("Dialog").CANCEL]).show()},getShortCode:function k(){__p&&__p();if(!this.carrier){this.carrier=parseInt(c("$")("selected_carrier").value,10);if(!this.carrier){this.start(true);return false}}c("Dialog").getCurrent()&&c("Dialog").getCurrent().setButtonsMessage('<img src="/images/loaders/indicator_blue_small.gif" />');new(c("AsyncRequest"))().setURI(this.AJAX_URI).setData({profile_id:this.profile_id,get_code:1,carrier:this.carrier,source:this.source,misc:this.misc}).setHandler(this.showShortCode.bind(this)).send();return false},showShortCode:function k(l){var m=l.getPayload();if(this.cb_obj&&this.cb_obj.onShowShortCode)this.cb_obj.onShowShortCode(m);else new(c("Dialog"))().setTitle(m.title).setBody(m.html).setHandler(this.activate.bind(this)).setButtons([c("Dialog").NEXT,c("Dialog").CANCEL]).show()},activate:function k(){var l=c("$")("sms_code").value;if(!l)return;var m=c("ge")("profile_add");m=m?m.checked:null;var n=c("ge")("message_on");n=n?n.checked:null;new(c("AsyncRequest"))().setURI(this.AJAX_URI).setData({profile_id:this.profile_id,confirm:1,code:l,profile_add:m,message_on:n,source:this.source,misc:this.misc}).setHandler(this.confirmCode.bind(this)).setErrorHandler(this.confirmCode.bind(this)).send()},confirmCode:function k(l){__p&&__p();var m=l.getPayload();if(!l.error&&m.success)if(this.cb_obj&&this.cb_obj.onActivationSuccess)this.cb_obj.onActivationSuccess(m);else{if(m.redirect_now){c("goURI")(m.redirect,m.force_redirect);return}if(m.redirect==null)return;this.redirect_uri=m.redirect;new(c("Dialog"))().setTitle(m.title).setBody(m.html).setHandler(this.redirect.bind(this)).setButtons([c("Dialog").OK]).show()}else if(this.cb_obj&&this.cb_obj.onActivationFailure)this.cb_obj.onActivationFailure(l);else c("AsyncResponse").defaultErrorHandler.call(this,l)},redirect:function k(){if(this.redirect_uri=="reload")c("ReloadPage").now();else c("goURI")(this.redirect_uri)},goVerification:function k(){new(c("AsyncRequest"))().setURI(this.AJAX_URI).setData({profile_id:this.profile_id,show_verification:1,source:this.source,misc:this.misc}).setHandler(this.displayVerification.bind(this)).send();return false},displayVerification:function k(l){var m=l.getPayload();if(this.cb_obj&&this.cb_obj.onDisplayVerification)this.cb_obj.onDisplayVerification(m);else new(c("Dialog"))().setTitle(m.title).setBody(m.html).setHandler(this.completeVerification.bind(this,l)).setButtons([c("Dialog").OK]).show()},completeVerification:function k(l){var m=l.getPayload();if(this.cb_obj)this.cb_obj.onVerificationComplete(m)}});f.exports=j}),null);
__d("legacy:mobile-sms-activation",["MobileSmsActivationController"],(function a(b,c,d,e,f,g){b.MobileSmsActivationController=c("MobileSmsActivationController");b.mobile_activation_show_carriers=c("MobileSmsActivationController").show_carriers;b.mobile_activation_update_carrier=c("MobileSmsActivationController").update_carrier}),3);