if (self.CavalryLogger) { CavalryLogger.start_js(["kgWlE"]); }

__d("P2PLinkConstants",[],(function a(b,c,d,e,f,g){f.exports={receiverIneligibleHelpURI:"http://www.facebook.com/help/1495718484027862",addDebitCardHelpURI:"http://www.facebook.com/help/200298266807261",helpCenterURI:"http://www.facebook.com/help/863171203733904",contactSupportURI:"http://www.facebook.com/help/contact/1491759007768605",disabledPaymentsSupportURI:"http://www.facebook.com/help/contact/223254857690713",complianceLearnMoreURI:"http://www.facebook.com/help/1555715811351399",complianceLearnMoreMsiteURI:"http://www.facebook.com/help/messenger-app/369959656515129",securePayInfoLearnMoreURI:"http://www.facebook.com/help/146373702454423",contactFraudTeamURI:"http://www.facebook.com/help/contact/370238886476028",payerProtectionURI:"http://www.facebook.com/payer_protection/",helpTransferSystemFailureURI:"http://www.facebook.com/help/contact/614010102040957",helpTransferManualReviewURI:"http://www.facebook.com/help/messenger-app/1463256903894928",helpTransferRecipientCanceledURI:"http://www.facebook.com/help/messenger-app/1564459413784472",helpTransferCompletedURI:"http://www.facebook.com/help/messenger-app/750020781733477",helpTransferCanceledSameCardURI:"http://www.facebook.com/help/messenger-app/818512131561533",helpTransferPushFailURI:"http://www.facebook.com/help/1386991644944095",settingsWWWURI:"http://www.facebook.com/settings?tab=payments",settingsMsiteURI:"http://m.facebook.com/settings/p2p/",mTermsURI:"http://www.facebook.com/legal/m",mHelpURI:"http://www.facebook.com/help/messenger-app/870471599656315",disputeURI:"http://www.facebook.com/help/contact/828169843971429",paymentMethodsURI:"https://www.facebook.com/settings?tab=payments&section=settings",paymentHistoryURI:"https://www.facebook.com/settings?tab=payments&section=history",paymentsTermsURI:"/payments_terms/"}}),null);
__d("MessagingThreadEventTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MessagingThreadEventLoggerConfig",this.$MessagingThreadEventTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MessagingThreadEventLoggerConfig",this.$MessagingThreadEventTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$MessagingThreadEventTypedLogger1={};return this};h.prototype.updateData=function(j){this.$MessagingThreadEventTypedLogger1=babelHelpers["extends"]({},this.$MessagingThreadEventTypedLogger1,j);return this};h.prototype.setActiveTimeMs=function(j){this.$MessagingThreadEventTypedLogger1.active_time_ms=j;return this};h.prototype.setClientEventTimeMs=function(j){this.$MessagingThreadEventTypedLogger1.client_event_time_ms=j;return this};h.prototype.setEvent=function(j){this.$MessagingThreadEventTypedLogger1.event=j;return this};h.prototype.setPageData=function(j){this.$MessagingThreadEventTypedLogger1.page_data=c("GeneratedLoggerUtils").serializeMap(j);return this};h.prototype.setPageID=function(j){this.$MessagingThreadEventTypedLogger1.page_id=j;return this};h.prototype.setScriptPath=function(j){this.$MessagingThreadEventTypedLogger1.script_path=j;return this};h.prototype.setSource=function(j){this.$MessagingThreadEventTypedLogger1.source=j;return this};h.prototype.setThreadID=function(j){this.$MessagingThreadEventTypedLogger1.thread_id=j;return this};h.prototype.setVC=function(j){this.$MessagingThreadEventTypedLogger1.vc=j;return this};var i={active_time_ms:true,client_event_time_ms:true,event:true,page_data:true,page_id:true,script_path:true,source:true,thread_id:true,vc:true};f.exports=h}),null);
__d("MessagingThreadEventType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ACTIVE:"active",INACTIVE:"inactive"})}),null);
__d("MessagingThreadSourceName",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CHAT_NUB:"chat_nub",MESSENGER:"messenger"})}),null);
__d("MessengerLoggerUtils",["MercuryIDs","MessagingThreadEventType","MessagingThreadEventTypedLogger","MessagingThreadSourceName","ScriptPath","pageID"],(function a(b,c,d,e,f,g){var h={logThreadChangeEvent:function i(j,k,l,m){if(l.activeThreadID&&j)this.log({activeThreadID:l.activeThreadID,event:c("MessagingThreadEventType").INACTIVE,clientEventTimeMs:k,activeTimeMs:k-j});if(m.activeThreadID)this.log({activeThreadID:m.activeThreadID,event:c("MessagingThreadEventType").ACTIVE,clientEventTimeMs:k,activeTimeMs:0})},log:function i(j){var k=c("MercuryIDs").tokenize(j.activeThreadID.toString()),l=c("ScriptPath").getPageInfo();new(c("MessagingThreadEventTypedLogger"))().setEvent(j.event).setClientEventTimeMs(j.clientEventTimeMs).setActiveTimeMs(j.activeTimeMs).setPageID(c("pageID")).setPageData(l?l.extraData:{}).setThreadID(k.value).setSource(c("MessagingThreadSourceName").MESSENGER).log()}};f.exports=h}),null);
__d("MessengerStateStore",["MessengerActions","MessengerLoggerUtils","MessengerStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("MessengerStore"));i=h&&h.prototype;function j(){i.constructor.call(this);this.$MessengerStateStore1={activeThreadID:null,detailView:null,filter:null,folder:null,masterView:null,query:null,mid:null,serverThreadID:null,extraQueryParams:null,threadIDs:null};this.$MessengerStateStore2=babelHelpers["extends"]({},this.$MessengerStateStore1);this.$MessengerStateStore4=this.$MessengerStateStore3=null}j.prototype.getState=function(){return this.$MessengerStateStore1};j.prototype.getPrevState=function(){return this.$MessengerStateStore2};j.prototype.__onDispatch=function(k){switch(k.type){case c("MessengerActions").Types.REPLACE_STATE:this.$MessengerStateStore2=this.$MessengerStateStore1;this.$MessengerStateStore4=this.$MessengerStateStore3;this.$MessengerStateStore1=babelHelpers["extends"]({activeThreadID:null,detailView:null,filter:null,folder:null,masterView:null,query:null,mid:null,serverThreadID:null,extraQueryParams:null,threadsIDs:null},k.nextState);var l=Date.now();this.$MessengerStateStore3=l;c("MessengerLoggerUtils").logThreadChangeEvent(this.$MessengerStateStore4,l,this.$MessengerStateStore2,this.$MessengerStateStore1);this.emitChange();break}};f.exports=new j()}),null);
__d("P2PBannerStore",["invariant","EventEmitter","P2PActionConstants","P2PAPI","P2PDispatcher"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=void 0,l={},m=false,n=false;i=babelHelpers.inherits(o,c("EventEmitter"));j=i&&i.prototype;function o(){j.constructor.call(this);k=c("P2PDispatcher").register(this.onEventDispatched.bind(this))}o.prototype.onEventDispatched=function(p){__p&&__p();var q=p.type,r=p.data;switch(q){case c("P2PActionConstants").BANNER_STATES_UPDATED:this.handleBannerStatesUpdated(r);this.emit("change");break;case c("P2PActionConstants").BANNER_DISMISSED:this.handleBannerDismissed(r);this.emit("change");break;case c("P2PActionConstants").BANNER_COMPLETED:this.handleBannerCompleted(r);this.emit("change");break}};o.prototype.handleBannerStatesUpdated=function(p){m=true;l=p};o.prototype.handleBannerDismissed=function(p){var q=this.getBannerState(p);q.hasBeenDismissed=true};o.prototype.shouldShowBanner=function(p){__p&&__p();var q=void 0;if(!n){c("P2PAPI").getBannerStates();n=true;return false}if(!m)return false;q=this.getBannerState(p);return q.eligible&&!q.hasBeenDismissed};o.prototype.handleBannerCompleted=function(p){var q=this.getBannerState(p);q.eligible=false};o.prototype.getBannerState=function(p){var q=l[p];q||h(0);return q};f.exports=new o()}),null);
__d("P2PPaymentRequest",["P2PPaymentRequestStatus","immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=Math.round(Date.now()/1e3);h=babelHelpers.inherits(k,c("immutable").Record({amount:"",amountWithSymbol:"",creationTime:j,currency:"",currentStatus:c("P2PPaymentRequestStatus").INITED,groupThreadFBID:"",id:"",individualRequests:[],memoText:"",requestee:{},requester:{},statusDescription:"",transfer:{},transferID:"",updatedTime:j}));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("P2PPaymentRequestsStore",["P2PActionConstants","Arbiter","ChannelConstants","CurrentUser","EventEmitter","immutable","ImmutableObject","P2PActions","P2PAPI","P2PChannelType","P2PDispatcher","P2PPaymentRequest","P2PPaymentRequestStatus"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("immutable").List,k=null,l=false,m=null,n=false,o=null,p=j(),q=false,r=false;h=babelHelpers.inherits(s,c("EventEmitter"));i=h&&h.prototype;function s(){i.constructor.call(this);c("Arbiter").subscribe(c("ChannelConstants").getArbiterType(c("P2PChannelType").PAYMENT_REQUEST_STATUS_CHANGED),this.handleChannelPaymentRequestStatusChanged.bind(this));c("P2PDispatcher").register(this.onEventDispatched.bind(this))}s.prototype.onEventDispatched=function(t){__p&&__p();var u=t.data,v=t.type;switch(v){case c("P2PActionConstants").PAYMENT_REQUEST_INITIATED:q=true;o=null;this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_INITIATED_COMPLETE:q=false;this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_CREATED:this.handlePaymentRequestCreated(u);this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_CREATED_ERROR:o=new(c("ImmutableObject"))(u.error);this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_UPDATED:this.handlePaymentRequestUpdated(u);this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_DECLINE_INITIATED:n=true;m=null;this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_DECLINED:n=false;m=null;this.handlePaymentRequestDeclined(u);this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_DECLINE_ERROR:n=false;m=new(c("ImmutableObject"))(u.error);this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_CANCEL_INITIATED:l=true;k=null;this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_CANCELED:l=false;k=null;this.handlePaymentRequestCanceled(u);this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUEST_CANCEL_ERROR:l=false;k=new(c("ImmutableObject"))(u.error);this.emit("change");break;case c("P2PActionConstants").DIALOG_CLOSED:m=null;this.emit("change");break;case c("P2PActionConstants").PAYMENT_REQUESTS_FETCHED:this.handlePaymentRequestsFetched(u);this.emit("change");break}};s.prototype.handlePaymentRequestCreated=function(t){var u=p.toArray();u.push(new(c("P2PPaymentRequest"))(t));u.sort(function(v,w){return v.creationTime-w.creationTime});p=j(u)};s.prototype.handlePaymentRequestUpdated=function(t){if(t.groupRequestID)this.updateIndividualRequest(t);delete t.groupRequestID;this.updateRequest(t.id,t)};s.prototype.handlePaymentRequestDeclined=function(t){this.updateRequest(t,{currentStatus:c("P2PPaymentRequestStatus").DECLINED})};s.prototype.handlePaymentRequestCanceled=function(t){this.updateRequest(t,{currentStatus:c("P2PPaymentRequestStatus").CANCELED})};s.prototype.handleChannelPaymentRequestStatusChanged=function(t,u){var v=u.obj;c("P2PActions").paymentRequestUpdated({id:v.id,currentStatus:v.current_status,groupRequestID:v.group_request_id,transfer:v.transfer})};s.prototype.handlePaymentRequestsFetched=function(t){this.$P2PPaymentRequestsStore1(t)};s.prototype.$P2PPaymentRequestsStore1=function(t){t=t.sort(function(v,w){return v.creationTime-w.creationTime});t.forEach(function(v,w){if(!this.getPaymentRequestByID(v.id))p=p.push(new(c("P2PPaymentRequest"))(v))}.bind(this));var u=p.toArray();u.sort(function(v,w){return v.creationTime-w.creationTime});p=j(u)};s.prototype.isPaymentRequestInitiated=function(){return q};s.prototype.isPaymentRequestDeclining=function(){return n};s.prototype.isPaymentRequestCanceling=function(){return l};s.prototype.getPaymentRequestByID=function(t){return p.find(function(u){return t===u.id})};s.prototype.getPaymentRequestError=function(){return o};s.prototype.getPaymentRequestDeclineError=function(){return m};s.prototype.getPaymentRequestCancelError=function(){return k};s.prototype.getPendingPaymentRequest=function(){if(!r){r=true;c("P2PAPI").getPendingPaymentRequests()}return p.filter(function(t){return t.requestee.id===c("CurrentUser").getID()&&t.currentStatus===c("P2PPaymentRequestStatus").INITED}).last()};s.prototype.updateRequest=function(t,u){p.forEach(function(v,w){if(t===v.id)p=p.set(w,v.merge(v,u))})};s.prototype.updateIndividualRequest=function(t){var u=t.id,v=t.groupRequestID,w=p.findIndex(function(C){return v===C.id}),x=p.get(w),y=x.individualRequests.findIndex(function(C){return u===C.id}),z=x.individualRequests.slice(0),A=z[y],B=babelHelpers["extends"]({},A,t);z[y]=B;x=x.set("individualRequests",z);p=p.set(w,x)};s.prototype.getPaymentRequests=function(){return p};f.exports=new s()}),null);
__d("P2PJewelBanner.react",["cx","fbt","ix","Image.react","Layout.react","P2PButton.react","React","TooltipLink.react","URI","XUIGrayText.react"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=c("Layout.react").FillColumn,n=c("Layout.react").Column,o=c("React").PropTypes;k=babelHelpers.inherits(p,c("React").Component);l=k&&k.prototype;function p(){__p&&__p();var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=l.constructor).call.apply(q,[this].concat(t)),this.handleCloseClick=function(v){v.stopPropagation();if(this.props.onClose)this.props.onClose()}.bind(this),this.handleClick=function(){this.execPrimaryClick()}.bind(this),this.handlePrimaryClick=function(v){v.stopPropagation();this.execPrimaryClick()}.bind(this),this.execPrimaryClick=function(){if(this.props.primaryActionConfig.uri)new(c("URI"))(this.props.primaryActionConfig.uri).go();this.props.primaryActionConfig.onClick&&this.props.primaryActionConfig.onClick()}.bind(this),this.handleSecondaryActionClick=function(v){v.stopPropagation();this.props.secondaryActionConfig&&this.props.secondaryActionConfig.onClick&&this.props.secondaryActionConfig.onClick()}.bind(this),this.renderCloseButton=function(){return c("React").createElement(c("TooltipLink.react"),{alignH:"center",className:"_47d8",href:"#",onClick:this.handleCloseClick,position:"above",tooltip:i._("\u062a\u062c\u0627\u0647\u0644")},c("React").createElement(c("Image.react"),{className:"_47dg",height:7,src:j("94375"),width:7}))}.bind(this),this.renderActions=function(){var v=this.props.primaryActionConfig,w=void 0,x=this.props.secondaryActionConfig;if(x)w=c("React").createElement(c("P2PButton.react"),{className:"_5d0t",href:"#",label:x.text,onClick:this.handleSecondaryActionClick,size:"large",target:"_blank",type:"primary"});return c("React").createElement("div",null,w,c("React").createElement(c("P2PButton.react"),{className:"_5d0t",href:v.uri||"#",label:v.text,onClick:this.handlePrimaryClick,size:"large",target:"_blank",type:"primary",use:"confirm"}))}.bind(this),r}p.prototype.render=function(){var q=void 0;if(this.props.isDismissable)q=this.renderCloseButton();return c("React").createElement("div",{className:"_5d0n",onClick:this.handleClick,role:"presentation"},q,c("React").createElement(c("Layout.react"),null,c("React").createElement(n,{className:"_400i"},c("React").createElement("div",{className:"_400j"},c("React").createElement(c("Image.react"),{className:"_5d0q",height:50,src:j("94376"),width:50}))),c("React").createElement(m,{className:"_47di"},c("React").createElement("div",{className:"_400j"},c("React").createElement(c("XUIGrayText.react"),{display:"block",shade:"dark",weight:"bold"},this.props.titleText),c("React").createElement(c("XUIGrayText.react"),{display:"block",shade:"light"},this.props.bodyText))),c("React").createElement(n,{className:"_400k"},c("React").createElement("div",{className:"_400j"},this.renderActions()))))};p.propTypes={bodyText:o.node,isDismissable:o.bool,onClose:o.func,primaryActionConfig:o.shape({onClick:o.func,text:o.node.isRequired,uri:o.oneOfType([o.string,o.object])}).isRequired,secondaryActionConfig:o.shape({onClick:o.func.isRequired,text:o.node.isRequired}),titleText:o.node.isRequired};p.defaultProps={isDismissable:false};f.exports=p}),null);
__d("P2PSimpleDialog.react",["fbt","FBPaymentsErrorNotice_DEPRECATED.react","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.handleToggle=function(r){if(!r)this.props.onCancel()}.bind(this),n}l.prototype.render=function(){var m=void 0;if(this.props.error)m=c("React").createElement(c("FBPaymentsErrorNotice_DEPRECATED.react"),{error:this.props.error});return c("React").createElement(c("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:false,onToggle:this.handleToggle,repositionOnUpdate:true,shown:true,width:this.props.width},c("React").createElement(c("P2PDialogTitle.react"),null,this.props.title),c("React").createElement(c("P2PDialogBody.react"),null,m,this.props.bodyText,c("React").createElement(c("P2PLoadingMask.react"),{visible:this.props.loading})),c("React").createElement(c("P2PDialogFooter.react"),null,c("React").createElement(c("P2PButton.react"),{disabled:this.props.loading,label:this.props.cancelButtonText,onClick:this.props.onCancel,size:"medium"}),c("React").createElement(c("P2PButton.react"),{disabled:this.props.loading,label:this.props.confirmButtonText,onClick:this.props.onConfirm,size:"medium",use:"confirm"})))};l.propTypes={bodyText:k.string.isRequired,cancelButtonText:k.string,confirmButtonText:k.string,error:k.object,loading:k.bool,onCancel:k.func.isRequired,onConfirm:k.func.isRequired,title:k.string.isRequired,width:k.number};l.defaultProps={cancelButtonText:h._("\u0625\u0644\u063a\u0627\u0621"),confirmButtonText:h._("\u062a\u0623\u0643\u064a\u062f"),width:300};f.exports=l}),null);
__d("P2PPaymentRequestCancelDialogContainer.react",["fbt","P2PActions","P2PAPI","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPaymentRequest","P2PPaymentRequestsStore","P2PSimpleDialog.react","React","StoreAndPropBasedStateMixin"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"P2PPaymentRequestCancelDialogContainer",mixins:[c("StoreAndPropBasedStateMixin")(c("P2PPaymentRequestsStore"))],propTypes:{paymentRequest:i.instanceOf(c("P2PPaymentRequest")).isRequired},statics:{calculateState:function k(l){return{error:c("P2PPaymentRequestsStore").getPaymentRequestCancelError(),loading:c("P2PPaymentRequestsStore").isPaymentRequestCanceling()}}},log:function k(l,m){c("P2PLogger").log(l,{www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_REQUEST,request_id:this.props.paymentRequest.id})},componentDidMount:function k(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CANCEL_REQUEST)},handleCancel:function k(){c("P2PActions").hideDialog()},handleConfirm:function k(){c("P2PAPI").cancelPaymentRequest({error:function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_REQUEST_FAIL)}.bind(this),paymentRequestID:this.props.paymentRequest.id,success:function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_REQUEST_SUCCESS)}.bind(this)});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_CANCEL_REQUEST)},renderBodyText:function k(){var l=this.props.paymentRequest.requestee.name;return h._("\u0633\u064a\u062a\u0645 \u0625\u0628\u0644\u0627\u063a {Name of requestee} \u0628\u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0637\u0644\u0628.",[h.param("Name of requestee",l)])},render:function k(){return c("React").createElement(c("P2PSimpleDialog.react"),{bodyText:this.renderBodyText(),error:this.state.error,loading:this.state.loading,cancelButtonText:h._("\u0639\u0648\u062f\u0629"),confirmButtonText:h._("\u0625\u0644\u063a\u0627\u0621"),onCancel:this.handleCancel,onConfirm:this.handleConfirm,title:h._("\u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0637\u0644\u0628\u061f")})}});f.exports=j}),null);
__d("P2PPaymentRequestDeclineDialogContainer.react",["fbt","P2PActions","P2PAPI","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPaymentRequest","P2PPaymentRequestsStore","P2PSimpleDialog.react","React","StoreAndPropBasedStateMixin"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"P2PPaymentRequestDeclineDialogContainer",mixins:[c("StoreAndPropBasedStateMixin")(c("P2PPaymentRequestsStore"))],propTypes:{paymentRequest:i.instanceOf(c("P2PPaymentRequest")).isRequired},statics:{calculateState:function k(l){return{error:c("P2PPaymentRequestsStore").getPaymentRequestDeclineError(),loading:c("P2PPaymentRequestsStore").isPaymentRequestDeclining()}}},log:function k(l,m){c("P2PLogger").log(l,{www_event_flow:c("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_REQUEST,request_id:this.props.paymentRequest.id})},componentDidMount:function k(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_DECLINE_REQUEST)},handleCancel:function k(){c("P2PActions").hideDialog()},handleConfirm:function k(){c("P2PAPI").declinePaymentRequest({error:function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_DECLINE_REQUEST_FAIL)}.bind(this),paymentRequestID:this.props.paymentRequest.id,success:function(){this.log(c("P2PPaymentLoggerEvent").UI_ACTN_DECLINE_REQUEST_SUCCESS)}.bind(this)});this.log(c("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_DECLINE_REQUEST)},renderBodyText:function k(){var l=this.props.paymentRequest.requester.name;return h._("\u0633\u064a\u062a\u0645 \u0625\u0631\u0633\u0627\u0644 \u0625\u0634\u0639\u0627\u0631 \u0625\u0644\u0649 {Name of requester} \u064a\u0641\u064a\u062f \u0628\u0631\u0641\u0636 \u0627\u0644\u0637\u0644\u0628.",[h.param("Name of requester",l)])},render:function k(){return c("React").createElement(c("P2PSimpleDialog.react"),{bodyText:this.renderBodyText(),error:this.state.error,loading:this.state.loading,cancelButtonText:h._("\u0639\u0648\u062f\u0629"),confirmButtonText:h._("\u0631\u0641\u0636"),onCancel:this.handleCancel,onConfirm:this.handleConfirm,title:h._("\u0647\u0644 \u062a\u0631\u064a\u062f \u0631\u0641\u0636 \u0627\u0644\u0637\u0644\u0628\u061f")})}});f.exports=j}),null);
__d("P2PPaymentRequestActionHelper",["fbt","MercuryIDs","P2PActions","P2PPaymentRequest","P2PPaymentRequestCancelDialogContainer.react","P2PPaymentRequestStatus","P2PPaymentRequestDeclineDialogContainer.react","P2PTransferParam","P2PTransferStatus"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=function i(k){switch(k){case c("P2PTransferStatus").CANCELED_DECLINED:return c("P2PPaymentRequestStatus").DECLINED;case c("P2PTransferStatus").CANCELED_EXPIRED:return c("P2PPaymentRequestStatus").EXPIRED;case c("P2PTransferStatus").CANCELED_RECIPIENT_RISK:case c("P2PTransferStatus").CANCELED_SAME_CARD:case c("P2PTransferStatus").CANCELED_SENDER_RISK:case c("P2PTransferStatus").CANCELED_SYSTEM_FAIL:return c("P2PPaymentRequestStatus").CANCELED;case c("P2PTransferStatus").COMPLETED:return c("P2PPaymentRequestStatus").TRANSFER_COMPLETED;case c("P2PTransferStatus").INTERMEDIATE_PROCESSING:case c("P2PTransferStatus").PENDING_PUSH_FAIL:case c("P2PTransferStatus").PENDING_SENDER_INITED:case c("P2PTransferStatus").PENDING_RECIPIENT_NUX:case c("P2PTransferStatus").PENDING_SENDER_VERIFICATION:case c("P2PTransferStatus").PENDING_SENDER_MANUAL_REVIEW:case c("P2PTransferStatus").PENDING_RECIPIENT_PROCESSING:case c("P2PTransferStatus").PENDING_RECIPIENT_VERIFICATION:case c("P2PTransferStatus").PENDING_RECIPIENT_MANUAL_REVIEW:case c("P2PTransferStatus").PENDING_SENDER_VERIFICATION_PROCESSING:case c("P2PTransferStatus").PENDING_RECIPIENT_VERIFICATION_PROCESSING:default:return c("P2PPaymentRequestStatus").TRANSFER_INITED}},j={initDeclinePaymentRequestFlow:function k(l){c("P2PActions").showDialog(c("P2PPaymentRequestDeclineDialogContainer.react"),{paymentRequest:l})},initPayForPaymentRequestFlow:function k(l,m){var n=[],o=l.groupThreadFBID,p=void 0;if(o){n.push(l.requester.id);p=c("MercuryIDs").getThreadIDFromThreadFBID(o)}else p=c("MercuryIDs").getThreadIDFromUserID(l.requester.id);c("P2PActions").chatSendViewOpened({amount:l.amount,memoText:l.memoText,paymentRequestID:l.id,threadID:p,useModal:true,referrer:m,groupSendRecipientUserIDs:n,groupThreadFBID:o})},initCancelPaymentRequestFlow:function k(l){c("P2PActions").showDialog(c("P2PPaymentRequestCancelDialogContainer.react"),{paymentRequest:l})},getPaymentRequest:function k(l){return new(c("P2PPaymentRequest"))({amount:l.amount,amountWithSymbol:l.amountWithSymbol,creationTime:l.creationTime,currency:l.currency,currentStatus:i(l[c("P2PTransferParam").STATUS]),groupThreadFBID:l.groupThreadFBID,individualRequests:[],memoText:l.memoText,requestee:l.sender,requester:l.receiver,statusDescription:l.statusDescription,trnasfer:l,transferID:l[c("P2PTransferParam").TRANSFER_ID],updatedTime:l.updatedTime})},getStatusText:function k(l){__p&&__p();var m=l.currentStatus,n=h._("\u0645\u0644\u063a\u0649"),o=h._("\u0645\u062f\u0641\u0648\u0639"),p=h._("\u0645\u0631\u0641\u0648\u0636"),q=h._("\u0645\u0639\u0644\u0642"),r=void 0;switch(m){case c("P2PPaymentRequestStatus").DECLINED:r=p;break;case c("P2PPaymentRequestStatus").CANCELED:case c("P2PPaymentRequestStatus").TRANSFER_FAILED:r=n;break;case c("P2PPaymentRequestStatus").TRANSFER_COMPLETED:r=o;break;default:r=q;break}return r}};f.exports=j}),null);
__d("P2PPendingPaymentRequestJewelBanner.react",["fbt","P2PJewelBanner.react","P2PPaymentRequest","P2PPaymentRequestActionHelper","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.handleDeclineClick=function(){c("P2PPaymentRequestActionHelper").initDeclinePaymentRequestFlow(this.props.paymentRequest)}.bind(this),this.handlePayClick=function(){c("P2PPaymentRequestActionHelper").initPayForPaymentRequestFlow(this.props.paymentRequest,"banner")}.bind(this),this.renderBodyText=function(){var r=this.props.paymentRequest,s=r.memoText;if(!s)return null;return h._("\u0645\u0642\u0627\u0628\u0644 {What the user paid for}",[h.param("What the user paid for",s)])}.bind(this),n}l.prototype.render=function(){var m=this.props.paymentRequest;return c("React").createElement(c("P2PJewelBanner.react"),{bodyText:this.renderBodyText(),primaryActionConfig:{onClick:this.handlePayClick,text:h._("\u062f\u0641\u0639")},secondaryActionConfig:{onClick:this.handleDeclineClick,text:h._("\u0631\u0641\u0636")},titleText:h._("\u062a\u0645 \u0637\u0644\u0628 {amount} \u0645\u0646 \u0642\u0628\u0644 {requester_name}",[h.param("requester_name",m.requester.name),h.param("amount",m.amountWithSymbol)])})};l.propTypes={paymentRequest:k.instanceOf(c("P2PPaymentRequest")).isRequired};f.exports=l}),null);
__d("P2PPendingPushFailJewelBanner.react",["fbt","P2PJewelBanner.react","P2PLinkConstants","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.getActionText=function(){return h._("\u062a\u0639\u0631\u0641 \u0639\u0644\u0649 \u0627\u0644\u0645\u0632\u064a\u062f")},this.getBodyText=function(){var r=this.props.transfer;return h._("\u062a\u0639\u0630\u0631 \u0625\u064a\u062f\u0627\u0639 {amount} {currency} \u0645\u0646 {sender_name} \u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0628\u0637\u0627\u0642\u0629 \u0627\u0644\u062e\u0635\u0645 \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0643.",[h.param("currency",r.currency),h.param("amount",r.amount),h.param("sender_name",r.sender.name)])}.bind(this),n}l.prototype.render=function(){return c("React").createElement(c("P2PJewelBanner.react"),{bodyText:this.getBodyText(),primaryActionConfig:{text:this.getActionText(),uri:c("P2PLinkConstants").helpTransferPushFailURI},titleText:h._("\u0642\u0645 \u0628\u062a\u062d\u062f\u064a\u062b \u0628\u0637\u0627\u0642\u062a\u0643")})};l.propTypes={transfer:k.object.isRequired};f.exports=l}),null);
__d("P2PAcceptMoneyDialog.react",["cx","BootloadedComponent.react","Bootloader","MessengerEnvironment","P2PDialog.react","P2PLoadingMask.react","JSResource","React","Run"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes,l=c("MessengerEnvironment").messengerui;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$P2PAcceptMoneyDialog1=function(){return c("React").createElement(c("P2PDialog.react"),{className:"_309"+(l?" _5ktw":""),layerHideOnBlur:false,repositionOnUpdate:true,shown:true,width:l?400:350},c("React").createElement("div",{className:"_3w2b"},c("React").createElement(c("P2PLoadingMask.react"),{visible:true})))},o}m.preload=function(){c("Run").onAfterLoad(function(){c("Bootloader").loadModules(["P2PAcceptMoneyDialogImpl.react"],function(){},"P2PAcceptMoneyDialog.react")})};m.prototype.render=function(){return c("React").createElement(c("BootloadedComponent.react"),babelHelpers["extends"]({bootloadLoader:c("JSResource")("P2PAcceptMoneyDialogImpl.react").__setRef("P2PAcceptMoneyDialog.react"),bootloadPlaceholder:this.$P2PAcceptMoneyDialog1()},this.props))};m.propTypes={creditCards:k.array.isRequired,useRedesignForm:k.bool,onClose:k.func,transfer:k.object};f.exports=m}),null);
__d("MessengerPaymentProductType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({P2P:"p2p",PAGES_COMMERCE:"pages_commerce",NMOR_PAGES_COMMERCE:"nmor_pages_commerce",MESSENGER_COMMERCE:"messenger_commerce"})}),null);
__d("P2PCreditCardStore",["P2PActionConstants","Arbiter","CreditCardFormParam","ChannelConstants","EventEmitter","ImmutableObject","MessengerPaymentProductType","P2PActions","P2PAPI","P2PChannelType","P2PCreditCard","P2PDispatcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=null,q=false,r=false;function s(v,w){if(v)o[v]=new(c("ImmutableObject"))(w)}function t(v,w){p=w;if(v)o[v]={error:w}}h=babelHelpers.inherits(u,c("EventEmitter"));i=h&&h.prototype;function u(){i.constructor.call(this);l=false;m=false;j=[];n=true;o={};k=c("P2PDispatcher").register(this.onEventDispatched.bind(this));c("Arbiter").subscribe(c("ChannelConstants").getArbiterType(c("P2PChannelType").CREDIT_CARD_CHANGED),this.handleChannelCreditCardChanged.bind(this));c("Arbiter").subscribe(c("ChannelConstants").getArbiterType(c("P2PChannelType").CREDIT_CARD_DELETED),this.handleChannelCreditCardDeleted.bind(this))}u.prototype.onEventDispatched=function(v){__p&&__p();var w=v.data,x=v.type;switch(x){case c("P2PActionConstants").CREDIT_CARD_SAVING:this.handleCreditCardSaving();this.emit("change");break;case c("P2PActionConstants").CREDIT_CARDS_UPDATED:this.handleCreditCardsUpdated(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARDS_UPDATED_ERROR:this.handleCreditCardsUpdatedError();this.emit("change");break;case c("P2PActionConstants").CHANNEL_EVENTS_ALLOWED:this.handleChannelEventsAllowed();break;case c("P2PActionConstants").CHANNEL_EVENTS_IGNORED:this.handleChannelEventsIgnored();break;case c("P2PActionConstants").CREDIT_CARD_ADDED:this.handleCreditCardAdded(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_ADDED_ERROR:this.handleCreditCardAddedError(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_ADDED_ERROR_CLEARED:this.handleCreditCardAddedErrorCleared();this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_DELETED:this.handleCreditCardDeleted(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_DELETED_ERROR:this.handleCreditCardDeletedError(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_UPDATED:this.handleCreditCardUpdated(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_UPDATED_ERROR:this.handleCreditCardUpdatedError(w);this.emit("change");break;case c("P2PActionConstants").PRESET_CREDIT_CARD_UPDATED:this.handlePresetCreditCardUpdated(w);this.emit("change");break;case c("P2PActionConstants").PRESET_CREDIT_CARD_UPDATED_ERROR:this.handlePresetCreditCardUpdatedError(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_VERIFIED:this.handleCreditCardVerified(w);this.emit("change");break;case c("P2PActionConstants").CREDIT_CARD_VERIFIED_ERROR:this.handleCreditCardVerifiedError(w);this.emit("change");break;case c("P2PActionConstants").BIN_NUMBER_VALIDATED:this.handleBINNumberValidated(w);this.emit("change");break;case c("P2PActionConstants").BIN_NUMBER_VALIDATED_ERROR:this.handleBINNumberValidatedError(w);this.emit("change");break}};u.prototype.handleCreditCardSaving=function(){q=true;p=null};u.prototype.getAsyncRequestState=function(){return o};u.prototype.isCreditCardsFetchComplete=function(){return l};u.prototype.handleCreditCardsUpdated=function(v){l=true;r=false;j=v.map(function(w){return new(c("P2PCreditCard"))(w)})};u.prototype.handleCreditCardsUpdatedError=function(){l=true;r=true};u.prototype.handleCreditCardAdded=function(v){q=false;s(v.requestID,v);if(!this.getCreditCardByCredentialID(v[c("CreditCardFormParam").CREDENTIAL_ID]))j.push(new(c("P2PCreditCard"))(v))};u.prototype.handleChannelEventsIgnored=function(){n=false};u.prototype.handleChannelEventsAllowed=function(){n=true};u.prototype.handleChannelCreditCardChanged=function(v,w){if(n&&!this.getCreditCardByCredentialID(w[c("CreditCardFormParam").CREDENTIAL_ID]))c("P2PAPI").getAllCreditCards()};u.prototype.handleCreditCardAddedError=function(v){q=false;t(v.requestID,v.errors)};u.prototype.handleCreditCardAddedErrorCleared=function(){p=null};u.prototype.handleCreditCardDeleted=function(v){var w=v[c("CreditCardFormParam").CREDENTIAL_ID];s(v.requestID,v);j=j.filter(function(x){return x.getCredentialId()!==w})};u.prototype.handleChannelCreditCardDeleted=function(v,w){w=w.obj;c("P2PActions").deleteCreditCard(w)};u.prototype.handleCreditCardDeletedError=function(v){t(v.requestID,v.error)};u.prototype.handleCreditCardUpdated=function(v){s(v.requestID,v);var w=this.getCreditCardByCredentialID(v[c("CreditCardFormParam").CREDENTIAL_ID]);if(w){w.setExp(v[c("CreditCardFormParam").CARD_EXPIRATION]);w.setZipCode(v[c("CreditCardFormParam").ZIP])}};u.prototype.handleCreditCardUpdatedError=function(v){t(v.requestID,v.errors)};u.prototype.handlePresetCreditCardUpdated=function(v){var w=v[c("CreditCardFormParam").CREDENTIAL_ID];s(v.requestID,v);var x=j.filter(function(z){return z.getIsPreset()})[0];if(x)x.setIsPreset(false);var y=this.getCreditCardByCredentialID(w);if(y)y.setIsPreset(true)};u.prototype.handlePresetCreditCardUpdatedError=function(v){t(v.requestID,v.error)};u.prototype.handleCreditCardVerified=function(v){s(v.requestID,v);var w=this.getCreditCardByCredentialID(v[c("CreditCardFormParam").CREDENTIAL_ID]);if(w)w.setIsVerified(true)};u.prototype.handleCreditCardVerifiedError=function(v){t(v.requestID,v.error)};u.prototype.handleBINNumberValidated=function(v){s(v.requestID,v)};u.prototype.handleBINNumberValidatedError=function(v){t(v.requestID,v.error)};u.prototype.getAll=function(v){v=v===undefined?c("MessengerPaymentProductType").P2P:v;if(!m){m=true;c("P2PAPI").getAllCreditCards()}return j.filter(function(w){if(v===c("MessengerPaymentProductType").P2P)return w.getIsPersonalTransferEligible();return w})};u.prototype.getCreditCardByCredentialID=function(v){return j.filter(function(w){return w.getCredentialId()===v})[0]};u.prototype.getDispatchToken=function(){return k};u.prototype.getSaveErrors=function(){return p};u.prototype.isSaving=function(){return q};u.prototype.failedCreditCardFetch=function(){return r};f.exports=new u()}),null);
__d("P2PTimeBasedAcceptMessage.react",["fbt","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.render=function(){var m=this.props.transfer,n=m.creationTime*1e3,o=1e3*60*60*24,p=Date.now(),q=(p-n)/o,r=m.expirationTimestamp*1e3-p,s=Math.round(Math.max(r/o,1)),t=void 0;if(q<=2)t=h._("\u0623\u0636\u0641 \u0628\u0637\u0627\u0642\u0629 \u062e\u0635\u0645 \u0648\u0633\u062a\u0645 \u0646\u0642\u0644 \u0627\u0644\u0623\u0645\u0648\u0627\u0644 \u0645\u0628\u0627\u0634\u0631\u0629 \u0625\u0644\u0649 \u0627\u0644\u0628\u0646\u0643 \u0627\u0644\u0630\u064a \u062a\u062a\u0639\u0627\u0645\u0644 \u0645\u0639\u0647.");else if(q<=4)t=h._("\u0633\u062a\u062a\u0645 \u0625\u0639\u0627\u062f\u0629 \u0625\u0631\u0633\u0627\u0644 \u0647\u0630\u0647 \u0627\u0644\u0623\u0645\u0648\u0627\u0644 \u062e\u0644\u0627\u0644 {days left} \u064a\u0648\u0645. \u0642\u0645 \u0628\u0625\u0636\u0627\u0641\u0629 \u0628\u0637\u0627\u0642\u0629 \u062e\u0635\u0645 \u0644\u0642\u0628\u0648\u0644\u0647\u0627.",[h.param("days left",s)]);else if(q<=5)t=h._({"day":"\u0644\u062f\u064a\u0643 {days left} \u064a\u0648\u0645\/\u0623\u064a\u0627\u0645 \u0645\u062a\u0628\u0642\u064a\u0629 \u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0637\u0627\u0642\u0629 \u062e\u0635\u0645 \u0642\u064a\u0644 \u0625\u0631\u062c\u0627\u0639 \u0627\u0644\u0646\u0642\u0648\u062f \u0625\u0644\u0649 {sender_name}.","days":"\u0644\u062f\u064a\u0643 {days left} \u064a\u0648\u0645 \u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0637\u0627\u0642\u0629 \u062e\u0635\u0645 \u0642\u0628\u0644 \u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u0623\u0645\u0648\u0627\u0644 \u0645\u0631\u0629 \u0623\u062e\u0631\u0649 \u0625\u0644\u0649 {sender_name}."},[h.param("days left",s),h["enum"](s===1?"day":"days",{day:"day",days:"days"}),h.param("sender_name",m.sender.name)]);else t=h._("\u0644\u062f\u064a\u0643 24 \u0633\u0627\u0639\u0629 \u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0637\u0627\u0642\u0629 \u062e\u0635\u0645 \u0642\u0628\u0644 \u0625\u0639\u0627\u062f\u0629 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u0623\u0645\u0648\u0627\u0644 \u0625\u0644\u0649 {sender_name}.",[h.param("sender_name",m.sender.name)]);return c("React").createElement("div",null,t)};function l(){i.apply(this,arguments)}l.propTypes={transfer:k.object.isRequired};f.exports=l}),null);
__d("P2PPendingRecipientNUXJewelBanner.react",["fbt","P2PAcceptMoneyDialog.react","P2PActions","P2PCreditCardStore","P2PJewelBanner.react","P2PTimeBasedAcceptMessage.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=c("React").createClass({displayName:"P2PPendingRecipientNUXJewelBanner",propTypes:{transfer:i.object.isRequired},getInitialState:function k(){return{creditCards:c("P2PCreditCardStore").getAll()}},creditCardStoreSub:null,componentDidMount:function k(){this.creditCardStoreSub=c("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange)},componentWillUnmount:function k(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null}},onCreditCardStoreChange:function k(){var l={creditCards:c("P2PCreditCardStore").getAll()};if(this.isMounted())this.setState(l)},handleClick:function k(){this.showAcceptMoneyDialog()},showAcceptMoneyDialog:function k(){c("P2PActions").showDialog(c("P2PAcceptMoneyDialog.react"),{creditCards:this.state.creditCards,onClose:c("P2PActions").hideDialog,transfer:this.props.transfer})},renderTimeBasedMessage:function k(){return c("React").createElement(c("P2PTimeBasedAcceptMessage.react"),{transfer:this.props.transfer})},render:function k(){var l=this.props.transfer;if(!c("P2PCreditCardStore").isCreditCardsFetchComplete())return null;return c("React").createElement(c("P2PJewelBanner.react"),{bodyText:this.renderTimeBasedMessage(),primaryActionConfig:{onClick:this.handleClick,text:h._("\u0625\u0636\u0627\u0641\u0629 \u0628\u0637\u0627\u0642\u0629")},titleText:h._("\u0642\u0628\u0648\u0644 {currency}{amount} \u0645\u0646 {sender_name}.",[h.param("currency",l.currency),h.param("amount",l.amount),h.param("sender_name",l.sender.name)])})}});f.exports=j}),null);
__d("P2PVerificationFlowHelper",["AsyncDialog","AsyncRequest","P2PAPI","P2PTransferParam","emptyFunction"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=null,j=null,k={startVerificationFlow:function l(m,n,o){h=m;i=n;j=o||c("emptyFunction");c("AsyncDialog").send(new(c("AsyncRequest"))("/p2p/verify/dialog/?id="+m))},setupFlowExitHandler:function l(m,n,o,p){__p&&__p();var q=function q(t){j(t);h=null;i=null;j=null;m.destroy();n.destroy()};if(o)m.subscribe("hide",function(){q(p)});else{var r=false,s=false;m.subscribe("confirm",function(){r=true});m.subscribe("hide",function(){if(r){m.destroy();n.destroy()}else if(i)n.show();else q(false)});n.subscribe("confirm",function(){s=true;var t={};t[c("P2PTransferParam").TRANSFER_ID]=h;c("P2PAPI").cancelTransaction({formData:t});q(false)});n.subscribe("hide",function(){if(!s)m.show()})}}};f.exports=k}),null);
__d("P2PPendingRecipientVerificationJewelBanner.react",["fbt","P2PJewelBanner.react","P2PTransferParam","P2PVerificationFlowHelper","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.handleClick=function(){c("P2PVerificationFlowHelper").startVerificationFlow(this.props.transfer[c("P2PTransferParam").TRANSFER_ID],false)}.bind(this),n}l.prototype.render=function(){return c("React").createElement(c("P2PJewelBanner.react"),{bodyText:h._("\u0644\u0642\u0628\u0648\u0644 \u0627\u0644\u0646\u0642\u0648\u062f \u0627\u0644\u062a\u064a \u062a\u0645 \u0625\u0631\u0633\u0627\u0644\u0647\u0627 \u0625\u0644\u064a\u0643 \u0645\u0646 \u0642\u0628\u0644 {sender_name}\u060c \u064a\u0631\u062c\u0649 \u062a\u0623\u0643\u064a\u062f \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0643.",[h.param("sender_name",this.props.transfer.sender.name)]),primaryActionConfig:{onClick:this.handleClick,text:h._("\u062a\u0623\u0643\u064a\u062f \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a")},titleText:h._("\u064a\u0631\u062c\u0649 \u062a\u0623\u0643\u064a\u062f \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0643")})};l.propTypes={transfer:k.object.isRequired};f.exports=l}),null);
__d("P2PJewelBannerContainer.react",["cx","CurrentUser","P2PBannerStore","P2PPaymentRequestsStore","P2PPendingPaymentRequestJewelBanner.react","P2PPendingPushFailJewelBanner.react","P2PPendingRecipientNUXJewelBanner.react","P2PPendingRecipientVerificationJewelBanner.react","P2PTransferParam","P2PTransferStatus","P2PTransferStore","PureStoreBasedStateMixin","React","gkx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").createClass({displayName:"P2PJewelBannerContainer",mixins:[c("PureStoreBasedStateMixin")(c("P2PBannerStore"),c("P2PPaymentRequestsStore"),c("P2PTransferStore"))],statics:{calculateState:function j(){var k=c("P2PTransferStore").getNUXTransfer(),l=c("P2PPaymentRequestsStore").getPendingPaymentRequest(),m=c("gkx")("AT7KSMdBbHFSBSJn1JWZUBa76yZr8D9pobYWWvzliNi0RZQsDI29awNxAAPfpbtiIQHouKzRc3uiaxxHhFXpGQGFiE6SMOOJwNKziF0lagOtKg");return{paymentRequest:l,paymentRequestBannerShown:!!l,transfer:k,transferBannerShown:m&&k&&k.receiver.id===c("CurrentUser").getID()}}},renderTransferBanner:function j(){var k=this.state.transfer,l=k[c("P2PTransferParam").STATUS];switch(l){case c("P2PTransferStatus").PENDING_RECIPIENT_NUX:return c("React").createElement(c("P2PPendingRecipientNUXJewelBanner.react"),{transfer:k});case c("P2PTransferStatus").PENDING_RECIPIENT_VERIFICATION:return c("React").createElement(c("P2PPendingRecipientVerificationJewelBanner.react"),{transfer:k});case c("P2PTransferStatus").PENDING_PUSH_FAIL:return c("React").createElement(c("P2PPendingPushFailJewelBanner.react"),{transfer:k})}},renderPaymentRequestBanner:function j(){return c("React").createElement(c("P2PPendingPaymentRequestJewelBanner.react"),{paymentRequest:this.state.paymentRequest})},render:function j(){var k=void 0;if(this.state.transferBannerShown)k=this.renderTransferBanner();else if(this.state.paymentRequestBannerShown)k=this.renderPaymentRequestBanner();return c("React").createElement("div",{className:"_1xfk"},k)}});f.exports=i}),null);
__d("MercuryThreadlistContainer.react",["Bootloader","emptyFunction","immutable","MercuryAPIArgsSource","MercuryConfig","MercuryFilters","MercuryIDs","MercuryThreadlistConstants","MessagingTag","P2PJewelBannerContainer.react","QE2Logger","React","SubscriptionsHandler","gkx","setImmediate","MessengerStateStore","MessengerMessageRequestsTypedLogger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes,k="search",l="www_messenger_jewel_perf_h2_2017",m=3,n=5e3;h=babelHelpers.inherits(o,c("React").Component);i=h&&h.prototype;function o(){__p&&__p();var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=i.constructor).call.apply(p,[this].concat(s)),this.state={aggregatedThreads:null,showAggregation:false,isLoading:true,isSearching:false,unreadMessageRequestThreads:[],threads:c("immutable").Map()},this.threadListReqsInFlight=0,this.$MercuryThreadlistContainer13=function(){__p&&__p();var u=function(){this.setState({suspended:false});this.handleThreadListUpdate()}.bind(this);if(c("MercuryConfig").deferJewelUpdateOnChatOpen&&c("MercuryConfig").deferJewelUpdateOnChatOpen==="setTimeout"){this.setState({suspended:true});setTimeout(u,n)}else if(c("MercuryConfig").deferJewelUpdateOnChatOpen&&c("MercuryConfig").deferJewelUpdateOnChatOpen==="requestIdleCallback"){this.setState({suspended:true});requestIdleCallback(u,{timeout:n})}}.bind(this),this.$MercuryThreadlistContainer19=function(){this.$MercuryThreadlistContainer1.getFilteredThreadlist(c("MercuryThreadlistConstants").RECENT_THREAD_OFFSET,c("MercuryThreadlistConstants").MAX_UNREAD_COUNT,c("MessagingTag").PENDING,c("MercuryFilters").UNREAD,this.$MercuryThreadlistContainer21,true,this.props.source)}.bind(this),this.$MercuryThreadlistContainer14=function(){if(this.props.folder!=="aggregation"&&!this.state.isSearching&&!this.state.isLoading&&!this.$MercuryThreadlistContainer1.hasLoadedThreadlist(this.props.folder,this.props.filter))this.$MercuryThreadlistContainer7(this.props.folder,this.props.filter,this.$MercuryThreadlistContainer8(this.props.folder)+c("MercuryThreadlistConstants").JEWEL_MORE_COUNT+1)}.bind(this),this.$MercuryThreadlistContainer21=function(){if(!this.$MercuryThreadlistContainer1||!this.$MercuryThreadlistContainer2)return;var u=this.$MercuryThreadlistContainer1.getAvailableThreadlistNow(c("MessagingTag").PENDING,c("MercuryFilters").UNREAD);this.$MercuryThreadlistContainer2.getMultiThreadMeta(u,function(v){this.setState({unreadMessageRequestThreads:u.map(function(w){return v[w]})})}.bind(this))}.bind(this),this.$MercuryThreadlistContainer16=function(u,v){this.setState({isLoading:v,searchThreads:[]},function(){return this.$MercuryThreadlistContainer12(k,c("MercuryFilters").ALL,u)}.bind(this))}.bind(this),this.$MercuryThreadlistContainer15=function(u){this.setState({isSearching:!!u})}.bind(this),this.$MercuryThreadlistContainer17=function(u,v){this.setState({showAggregation:true,aggregatedThreads:v});var w=c("MercuryIDs").getParticipantIDFromUserID(this.props.viewer),x=[],y=v.map(function(z){x.push(c("MercuryIDs").getThreadKeyfromThreadIDUserID(z.thread_id,c("MercuryIDs").tokenize(w).value));return z.thread_id});this.props.onAggregationClick&&this.props.onAggregationClick(u,y);new(c("MessengerMessageRequestsTypedLogger"))().setAction("aggregation_entrypoint_tap").setEntryPoint("inbox_aggregation").setSurface("inbox").setFolderType("pending").setThreadKeyList(x.filter(function(z){return z}).join(", ")).log()}.bind(this),q}o.prototype.componentWillMount=function(){this.setState({showAggregation:c("MessengerStateStore").getState()&&c("MessengerStateStore").getState().threadIDs!==null})};o.prototype.componentDidMount=function(){__p&&__p();c("QE2Logger").logExposureForUser(l);c("Bootloader").loadModules(["MercuryOrderedThreadlist","MercuryThreadInformer","MercuryThreads"],function(p,q,r){__p&&__p();if(this.props.resetAggregatedThreads)this.setState({showAggregation:false,aggregatedThreads:null});this.$MercuryThreadlistContainer1=p.getForFBID(this.props.viewer);this.$MercuryThreadlistContainer2=r.getForFBID(this.props.viewer);this.$MercuryThreadlistContainer3=function(){__p&&__p();var s=this.$MercuryThreadlistContainer1.getAvailableThreadlistNow(c("MessagingTag").INBOX,this.props.filter);if(s.length===0)return s;var t=this.$MercuryThreadlistContainer2.getThreadMetaNow(s[s.length-1]);if(!t)return s;var u=t.timestamp,v=this.$MercuryThreadlistContainer1.getThreadlistUntilTimestamp(u,c("MessagingTag").PENDING,this.props.filter);v.sort(function(x,y){var z=this.$MercuryThreadlistContainer2.getThreadMetaNow(x),A=this.$MercuryThreadlistContainer2.getThreadMetaNow(y);return(A&&A.timestamp)-(z&&z.timestamp)}.bind(this));var w=c("MercuryConfig").MCMA?this.$MercuryThreadlistContainer4(v):v;return s.concat(w).sort(function(x,y){var z=typeof x==="string"?this.$MercuryThreadlistContainer2.getThreadMetaNow(x):this.$MercuryThreadlistContainer2.getThreadMetaNow(x[0]),A=typeof y==="string"?this.$MercuryThreadlistContainer2.getThreadMetaNow(y):this.$MercuryThreadlistContainer2.getThreadMetaNow(y[0]);return(A&&A.timestamp)-(z&&z.timestamp)}.bind(this))}.bind(this);this.$MercuryThreadlistContainer5=q.getForFBID(this.props.viewer);this.$MercuryThreadlistContainer6=new(c("SubscriptionsHandler"))();this.$MercuryThreadlistContainer6.addSubscriptions(this.$MercuryThreadlistContainer5.subscribe("threadlist-updated",function(s,t){if(!this.state.suspended)this.handleThreadListUpdate()}.bind(this)));if(c("MercuryConfig").MessengerInboxRequests)this.$MercuryThreadlistContainer7(c("MessagingTag").PENDING,this.props.filter,this.$MercuryThreadlistContainer8(c("MessagingTag").PENDING)+c("MercuryThreadlistConstants").CONNECTION_REQUEST);this.$MercuryThreadlistContainer9(this.props.folder,this.props.filter)}.bind(this),"MercuryThreadlistContainer.react")};o.prototype.componentWillReceiveProps=function(p){if(p.resetAggregatedThreads!==this.props.resetAggregatedThreads||p.folder!==this.props.folder||p.filter!==this.props.filter||p.folder===c("MessagingTag").INBOX&&this.state.showAggregation==true)this.$MercuryThreadlistContainer9(p.folder,p.filter)};o.prototype.componentDidUpdate=function(){if(this.props.resetAggregatedThreads&&this.state.showAggregation)this.setState({showAggregation:false,aggregatedThreads:null})};o.prototype.componentWillUnmount=function(){this.$MercuryThreadlistContainer10();this.$MercuryThreadlistContainer11();this.$MercuryThreadlistContainer6&&this.$MercuryThreadlistContainer6.release()};o.prototype.handleThreadListUpdate=function(){this.$MercuryThreadlistContainer12(this.props.folder,this.props.filter);if(c("MercuryConfig").MessengerInboxRequests){this.props.folder===c("MessagingTag").INBOX&&this.$MercuryThreadlistContainer12(c("MessagingTag").PENDING,this.props.filter);this.props.folder===c("MessagingTag").PENDING&&this.$MercuryThreadlistContainer12(c("MessagingTag").INBOX,this.props.filter)}};o.prototype.render=function(){var p=this.props,q=p.ChildClass,r=p.folder,s=p.filter,t=babelHelpers.objectWithoutProperties(p,["ChildClass","folder","filter"]),u=this.state.isSearching?this.state.threads.get(k)||[]:this.state.threads.get(r)||[];return c("React").createElement(q,babelHelpers["extends"]({},t,{filter:this.props.filter,folder:r,isLoaded:r==="aggregation"||!!this.$MercuryThreadlistContainer1&&this.$MercuryThreadlistContainer1.hasLoadedThreadlist(r,s),isLoading:this.state.isLoading,isSearching:this.state.isSearching,newMessageRequestThreads:this.state.unreadMessageRequestThreads,onRenderThreads:this.props.onRenderThreads,onMessageRequestsClick:this.props.onMessageRequestsClick,showAggregation:this.state.showAggregation,threads:this.state.aggregatedThreads||u,onLoadMoreRequest:this.$MercuryThreadlistContainer14,onQuery:this.$MercuryThreadlistContainer15,onSearchResults:this.$MercuryThreadlistContainer16,onAggregationClick:this.$MercuryThreadlistContainer17,p2pJewelBannerContainer:this.$MercuryThreadlistContainer18(),maxInitialThreadCount:this.props.threadCount,handleChatTabOpen:this.props.source==="jewel"&&c("MercuryConfig").deferJewelUpdateOnChatOpen&&c("MercuryConfig").deferJewelUpdateOnChatOpen!=="none"?this.$MercuryThreadlistContainer13:c("emptyFunction")}))};o.prototype.$MercuryThreadlistContainer4=function(p){__p&&__p();var q=c("MercuryConfig").Unit||3,r=(c("MercuryConfig").Duration||3)*1e3*60*60*24,s=p.map(function(A){return this.$MercuryThreadlistContainer2.getThreadMetaNow(A).timestamp}.bind(this)),t=[];for(var u=0;u<s.length;u++){var v=s[u],w=s[u+q-1];if(w&&v-w<r){var x=[p[u]];for(var y=u+1;y<s.length;y++){var z=s[y];if(z&&v-z<r){x.push(p[y]);u++}else break}t.push(x)}else t.push(p[u])}return t};o.prototype.$MercuryThreadlistContainer18=function(){return c("gkx")("AT7cgeSh9oAiqKXsZQMaQ0v7FtvEHhwTCbBqQoShv2Z1PYB6xIXtB41izv6pn31yyYHiuLVko2wBqrvyvW5pK7u0")&&!c("gkx")("AT7KSMdBbHFSBSJn1JWZUBa76yZr8D9pobYWWvzliNi0RZQsDI29awNxAAPfpbtiIQHouKzRc3uiaxxHhFXpGQGFiE6SMOOJwNKziF0lagOtKg")?null:c("React").createElement(c("P2PJewelBannerContainer.react"),null)};o.prototype.$MercuryThreadlistContainer9=function(p,q){__p&&__p();if(p==="aggregation")return;var r=c("MessengerStateStore").getState()&&c("MessengerStateStore").getState().threadIDs||this.props.threadIDs;if(!r)this.setState({showAggregation:false,aggregatedThreads:null});if(!c("MercuryConfig").MessengerInboxRequests&&p===c("MessagingTag").INBOX&&(c("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h")||this.props.source!==c("MercuryAPIArgsSource").JEWEL))this.$MercuryThreadlistContainer19();if(!this.$MercuryThreadlistContainer20(p,q))this.$MercuryThreadlistContainer7(p,q,this.props.threadCount||c("MercuryThreadlistConstants").JEWEL_THREAD_COUNT+m);else if(this.state.isLoading)this.setState({isLoading:false},function(){this.$MercuryThreadlistContainer12(p,q)}.bind(this));else this.$MercuryThreadlistContainer12(p,q)};o.prototype.$MercuryThreadlistContainer7=function(p,q,r){__p&&__p();if(!this.$MercuryThreadlistContainer1)return;this.$MercuryThreadlistContainer11();this.threadListReqsInFlight++;var s=function(){this.props.onDataFetchStart&&this.props.onDataFetchStart();var t=this.$MercuryThreadlistContainer1.getFilteredThreadlist(c("MercuryThreadlistConstants").RECENT_THREAD_OFFSET,r,p,q||c("MercuryFilters").ALL,function(u){this.threadListReqsInFlight--;if(this.threadListReqsInFlight===0){this.props.onDataFetchEnd&&this.props.onDataFetchEnd();this.setState({isLoading:false})}}.bind(this),true,this.props.source);this.$MercuryThreadlistContainer22={subscriberID:t,folder:p,filter:q}}.bind(this);if(c("gkx")("AT5u5y_2tbhjuTdh4Kg2TdttLGS73_JvpjKP4T3yUcEdoy0MQDkxKReXeNqyeJEnucpDEVsNLY6wuulEjaRK0PN7")&&this.state.isLoading)c("setImmediate")(s);else this.setState({isLoading:true},s)};o.prototype.$MercuryThreadlistContainer12=function(p,q,r){__p&&__p();if(!this.$MercuryThreadlistContainer1||!this.$MercuryThreadlistContainer2)return;this.$MercuryThreadlistContainer10();var s=void 0;if(c("MercuryConfig").MessengerInboxRequests&&p===c("MessagingTag").INBOX)s=this.$MercuryThreadlistContainer3();else if(p==="aggregation"||this.state.showAggregation){s=c("MessengerStateStore").getState()&&c("MessengerStateStore").getState().threadIDs||this.props.threadIDs;this.$MercuryThreadlistContainer23(s)}else s=r||this.$MercuryThreadlistContainer1.getAvailableThreadlistNow(p,q);var t=[].concat.apply([],s);this.$MercuryThreadlistContainer24=this.$MercuryThreadlistContainer2.getMultiThreadMeta(t,function(r){this.setState({threads:this.state.threads.set(p,this.$MercuryThreadlistContainer25(s,r))})}.bind(this))};o.prototype.$MercuryThreadlistContainer23=function(p){__p&&__p();var q=this.$MercuryThreadlistContainer1.getAvailableThreadlistNow(c("MessagingTag").PENDING,this.props.filter);if(p&&p.length>0){var r=p.filter(function(s){return q.indexOf(s)!==-1});this.$MercuryThreadlistContainer2.getMultiThreadMeta(r,function(s){if(!Array.isArray(s))s=Object.values(s);this.setState({aggregatedThreads:s})}.bind(this))}else this.setState({aggregatedThreads:null})};o.prototype.$MercuryThreadlistContainer25=function(p,q){return p.map(function(r){if(Array.isArray(r))return r.map(function(s){return q[s]});else return q[r]})};o.prototype.$MercuryThreadlistContainer20=function(p,q){var r=this.props.threadCount||c("MercuryThreadlistConstants").JEWEL_THREAD_COUNT+m;return!!(this.$MercuryThreadlistContainer1&&(this.$MercuryThreadlistContainer1.getThreadCount(p,q)>=r||this.$MercuryThreadlistContainer1.hasLoadedThreadlist(p,q)))};o.prototype.$MercuryThreadlistContainer8=function(p){var q=this.state.threads.get(p);return q?q.length:0};o.prototype.$MercuryThreadlistContainer10=function(){this.$MercuryThreadlistContainer2&&this.$MercuryThreadlistContainer24&&this.$MercuryThreadlistContainer2.unsubscribe(this.$MercuryThreadlistContainer24)};o.prototype.$MercuryThreadlistContainer11=function(){this.$MercuryThreadlistContainer1&&this.$MercuryThreadlistContainer22&&this.$MercuryThreadlistContainer1.unsubscribe(this.$MercuryThreadlistContainer22.subscriberID,this.$MercuryThreadlistContainer22.folder,this.$MercuryThreadlistContainer22.filter)};o.propTypes={ChildClass:j.func.isRequired,filter:j.string.isRequired,folder:j.string.isRequired,onMessageRequestsClick:j.func,onRenderThreads:j.func,onDataFetchStart:j.func,onDataFetchEnd:j.func,onAggregationClick:j.func,showCount:j.bool,showPresence:j.bool,source:j.string,threadCount:j.number,threadIDs:j.array,viewer:j.string.isRequired,onRenderBackArrow:j.func,resetAggregatedThreads:j.bool};o.defaultProps={source:c("MercuryAPIArgsSource").JEWEL};f.exports=o}),null);
__d("MercuryOrderedThreadlist",["invariant","LogHistory","MercuryActionType","MercuryAPIArgsSource","MercuryDispatcher","MercuryFilters","MercuryFolders","MercuryPayloadSource","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap","MessagingTag","PageMessageEnumTag","RangedCallbackManager","MercuryThreadInformer","MercuryThreads","gkx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("LogHistory").getInstance("ordered_threadlist_model"),j=c("MercuryFilters").getSupportedFilters().concat([c("MercuryFilters").ALL,c("MessagingTag").GROUPS]),k=c("MercuryFolders").getSupportedFolders().concat([c("MessagingTag").SPAM,c("MessagingTag").PAGE_BACKGROUND]);l.getForFBID=function(o){return n.getForFBID(o)};l.get=function(){return n.get()};function l(o){__p&&__p();this.$MercuryOrderedThreadlist1=o;this.$MercuryOrderedThreadlist2=c("MercuryThreadIDMap").getForFBID(this.$MercuryOrderedThreadlist1);this.$MercuryOrderedThreadlist3=c("MercuryThreadInformer").getForFBID(this.$MercuryOrderedThreadlist1);this.$MercuryOrderedThreadlist4=c("MercuryThreads").getForFBID(this.$MercuryOrderedThreadlist1);this.$MercuryOrderedThreadlist5=c("MercuryDispatcher").getForFBID(this.$MercuryOrderedThreadlist1);this.$MercuryOrderedThreadlist6={};this.$MercuryOrderedThreadlist7();this.$MercuryOrderedThreadlist5.subscribe("update-threadlist",function(p,q){__p&&__p();if(!m(q))return;var r=q.ordered_threadlists;if(r&&r.length)this.$MercuryOrderedThreadlist8(r);else{var s=(q.actions||[]).filter(function(t){return t.thread_id});this.$MercuryOrderedThreadlist9(q.threads||[]);this.$MercuryOrderedThreadlist10(s)}this.$MercuryOrderedThreadlist3.updatedThreadlist()}.bind(this));this.$MercuryOrderedThreadlist5.subscribe("invalidate-global-state",function(){return this.$MercuryOrderedThreadlist11()}.bind(this))}l.prototype.getThreadlistOrderMap=function(o,p){if(!this.$MercuryOrderedThreadlist6[o][p]){j=j.concat([p]);k.forEach(function(o){this.$MercuryOrderedThreadlist6[o][p]=new(c("RangedCallbackManager"))(function(q){var r=this.$MercuryOrderedThreadlist4.getThreadMetaNow(q);return r&&r.timestamp}.bind(this),function(q,r){return r-q},this.$MercuryOrderedThreadlist2.canLinkExternally.bind(this.$MercuryOrderedThreadlist2))}.bind(this))}return this.$MercuryOrderedThreadlist6[o][p]};l.prototype.getThreadlist=function(o,p,q,r,s,t){return this.getFilteredThreadlist(o,p,q,c("MercuryFilters").ALL,r,s,t)};l.prototype.getFilteredThreadlist=function(o,p,q,r,s,t,u){__p&&__p();var v=this.getThreadlistOrderMap(q,r),w=v.executeOrEnqueue(o,p,s,t),x=v.getUnavailableResources(w),y=v.getError(o,p,t);if(x.length||y){if(v.getCurrentArraySize()<o){var z={start:o,limit:p,filter:r,resources_size:v.getCurrentArraySize()};i.warn("range_with_gap",JSON.stringify(z))}v.setError(false);this.getServerRequests().fetchThreadlistInfo(v.getCurrentArraySize(),x.length,q,r==c("MercuryFilters").ALL?null:r,u,this.$MercuryOrderedThreadlist12(v.getAllResources()))}return w};l.prototype.getServerRequests=function(){return c("MercuryServerRequests").getForFBID(this.$MercuryOrderedThreadlist1)};l.prototype.getThreadlistUntilTimestamp=function(o,p,q){q=q||c("MercuryFilters").ALL;return this.getThreadlistOrderMap(p,q).getElementsUntil(o)};l.prototype.getAvailableThreadlistNow=function(o,p){p=p||c("MercuryFilters").ALL;return this.getThreadlistOrderMap(o,p).getAllResources()};l.prototype.getThreadCount=function(o,p){p=p||c("MercuryFilters").ALL;return this.getThreadlistOrderMap(o,p).getCurrentArraySize()};l.prototype.hasLoadedThreadlist=function(o,p){p=p||c("MercuryFilters").ALL;return this.getThreadlistOrderMap(o,p).hasReachedEndOfArray()};l.prototype.unsubscribe=function(o,p,q){q=q||c("MercuryFilters").ALL;this.getThreadlistOrderMap(p,q).unsubscribe(o)};l.prototype.$MercuryOrderedThreadlist11=function(){this.$MercuryOrderedThreadlist6={};this.$MercuryOrderedThreadlist7()};l.prototype.$MercuryOrderedThreadlist7=function(){k.forEach(function(o){this.$MercuryOrderedThreadlist6[o]={};j.forEach(function(p){this.$MercuryOrderedThreadlist6[o][p]=new(c("RangedCallbackManager"))(function(q){var r=this.$MercuryOrderedThreadlist4.getThreadMetaNow(q);return r&&r.timestamp}.bind(this),function(q,r){return r-q},this.$MercuryOrderedThreadlist2.canLinkExternally.bind(this.$MercuryOrderedThreadlist2))}.bind(this))}.bind(this))};l.prototype.$MercuryOrderedThreadlist13=function(o,p,q){var r=this.$MercuryOrderedThreadlist4.getThreadMetaNow(o);return!!(r&&r.timestamp&&q&&p&&this.$MercuryOrderedThreadlist14(o)==p&&this.$MercuryOrderedThreadlist15(o).includes(q))};l.prototype.$MercuryOrderedThreadlist16=function(o,p,q){__p&&__p();var r,s=this,t=[],u=false,v=false,w=(o||[]).filter(function(A){var B=A.filter||c("MercuryFilters").ALL;return(A.folder==p||!A.folder&&p==c("MessagingTag").INBOX)&&B==q}),x=this.$MercuryOrderedThreadlist6[p][q].getAllResources(),y=void 0;w.forEach(function(A){__p&&__p();t=t.concat(A.thread_ids);if(A.error){if(A.end>x.length)v=A.error}else{var B=A.end-A.start;if(A.thread_ids.length<B)u=true}if(!y||A.end>y)y=A.end});this.$MercuryOrderedThreadlist17(t,p,q);if(u)this.$MercuryOrderedThreadlist6[p][q].setReachedEndOfArray();else if(v)this.$MercuryOrderedThreadlist6[p][q].setError(v);else{var z=this.$MercuryOrderedThreadlist6[p][q].getCurrentArraySize();if(y&&z<y)(function(){var A={},B=x.concat(t),C=B.filter(function(D){var E=A[D];A[D]=true;return E});if(C.length){i.warn("duplicate_threads",JSON.stringify({folder:p,expected_final_size:y,actual_final_size:z,duplicate_thread_ids:C}));s.getServerRequests().fetchThreadlistInfo(y,C.length,p,q==c("MercuryFilters").ALL?null:q,c("MercuryAPIArgsSource").MERCURY,s.$MercuryOrderedThreadlist12(s.$MercuryOrderedThreadlist6[p][q].getAllResources()))}})()}};l.prototype.$MercuryOrderedThreadlist8=function(o){k.forEach(function(p){j.forEach(function(q){this.$MercuryOrderedThreadlist16(o,p,q)}.bind(this))}.bind(this))};l.prototype.$MercuryOrderedThreadlist10=function(o){__p&&__p();var p={},q=this.$MercuryOrderedThreadlist4;k.forEach(function(r){p[r]={};j.forEach(function(s){p[r][s]={to_add:[],to_remove:[],to_remove_if_last_after_add:{}}})});o.forEach(function(r){__p&&__p();var s=r.thread_id;this.$MercuryOrderedThreadlist18(s,function(t){__p&&__p();this.$MercuryOrderedThreadlist19(s,function(u){__p&&__p();var v=function(){u.forEach(function(x){if(!j.includes(x))return;!!t||h(0);p[t][x].to_add.push(s);if(!this.$MercuryOrderedThreadlist6[t][x].hasReachedEndOfArray()&&!this.$MercuryOrderedThreadlist6[t][x].hasResource(s))p[t][x].to_remove_if_last_after_add[s]=true}.bind(this))}.bind(this);function w(x){!!t||h(0);if(j.includes(x))if(u.includes(x))p[t][x].to_add.push(s);else p[t][x].to_remove.push(s)}if(!t){if(r.action_type===c("MercuryActionType").CHANGE_FOLDER||r.action_type===c("MercuryActionType").CHANGE_ARCHIVED_STATUS)k.forEach(function(x){if(x!==t)j.forEach(function(y){this.$MercuryOrderedThreadlist6[x][y].removeResources([s])}.bind(this))}.bind(this));return}!!t||h(0);switch(r.action_type){case c("MercuryActionType").DELETE_THREAD:u.forEach(function(x){if(!j.includes(x))return;p[t][x].to_remove.push(s)});break;case c("MercuryActionType").CHANGE_ARCHIVED_STATUS:case c("MercuryActionType").CHANGE_FOLDER:v();break;case c("MercuryActionType").CHANGE_READ_STATUS:w(c("MessagingTag").UNREAD);break;case c("MercuryActionType").USER_GENERATED_MESSAGE:case c("MercuryActionType").LOG_MESSAGE:u.forEach(function(x){if(!j.includes(x))return;if(this.$MercuryOrderedThreadlist13(s,t,x))p[t][x].to_add.push(s)}.bind(this));break;case c("MercuryActionType").CHANGE_FLAG:w(c("PageMessageEnumTag").FLAG);break}}.bind(this))}.bind(this))}.bind(this));k.forEach(function(r){__p&&__p();j.forEach(function(s){var t=this.$MercuryOrderedThreadlist6[r][s];this.$MercuryOrderedThreadlist17(p[r][s].to_add,r,s);for(var u=t.getCurrentArraySize()-1;u>=0;u--){var v=t.getResourceAtIndex(u);if(!p[r][s].to_remove_if_last_after_add[v])break;p[r][s].to_remove.push(v)}t.removeResources(p[r][s].to_remove)}.bind(this))}.bind(this))};l.prototype.$MercuryOrderedThreadlist9=function(o){__p&&__p();var p={};k.forEach(function(q){p[q]={};j.forEach(function(r){p[q][r]=[]})});o.forEach(function(q){this.$MercuryOrderedThreadlist18(q.thread_id,function(r){this.$MercuryOrderedThreadlist19(q.thread_id,function(s){if(r)s.forEach(function(t){if(this.$MercuryOrderedThreadlist13(q.thread_id,r,t))p[r][t].push(q.thread_id)}.bind(this))}.bind(this))}.bind(this))}.bind(this));k.forEach(function(q){j.forEach(function(r){if(p[q][r].length>0)this.$MercuryOrderedThreadlist17(p[q][r],q,r)}.bind(this))}.bind(this))};l.prototype.$MercuryOrderedThreadlist17=function(o,p,q){q=q||c("MercuryFilters").ALL;this.$MercuryOrderedThreadlist6[p][q].addResources(o);k.forEach(function(r){if(r!=p)this.$MercuryOrderedThreadlist6[r][q].removeResources(o)}.bind(this))};l.prototype.$MercuryOrderedThreadlist18=function(o,p){this.$MercuryOrderedThreadlist4.getThreadMeta(o,function(q){p(this.$MercuryOrderedThreadlist14(o,q))}.bind(this))};l.prototype.$MercuryOrderedThreadlist14=function(o,p){__p&&__p();p=p||this.$MercuryOrderedThreadlist4.getThreadMetaNow(o);var q=null;if(!p)q="No thread metadata";else if(!p.folder)q="No thread folder";if(q){var r={error:q,tid:o};i.warn("no_thread_folder",JSON.stringify(r));return null}!!p||h(0);var s=p.folder;if(p.is_archived)s=c("MessagingTag").ACTION_ARCHIVED;if(this.$MercuryOrderedThreadlist6[s])return s;else return null};l.prototype.$MercuryOrderedThreadlist19=function(o,p){this.$MercuryOrderedThreadlist4.getThreadMeta(o,function(q){p(this.$MercuryOrderedThreadlist15(o,q))}.bind(this))};l.prototype.$MercuryOrderedThreadlist15=function(o,p){__p&&__p();p=p||this.$MercuryOrderedThreadlist4.getThreadMetaNow(o);var q=[c("MercuryFilters").ALL];if(!p){var r={error:"no_thread_metadata",tid:o};i.warn("no_thread_metadata",JSON.stringify(r));return[]}if(p.unread_count)q.push(c("MessagingTag").UNREAD);if(!p.is_canonical)q.push(c("MessagingTag").GROUPS);var s=p.page_thread_info;if(s&&s.flagged)q.push(c("PageMessageEnumTag").FLAG);return q};l.prototype.$MercuryOrderedThreadlist12=function(o){var p=null;if(o.length>0){var q=this.$MercuryOrderedThreadlist4.getThreadMetaNow(o[o.length-1]);p=q?q.timestamp:null}return p};function m(o){switch(o.payload_source){case c("MercuryPayloadSource").CLIENT_CHANGE_ARCHIVED_STATUS:case c("MercuryPayloadSource").CLIENT_CHANGE_PAGE_FOLLOW_UP_STATUS:case c("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS:case c("MercuryPayloadSource").CLIENT_CHANGE_FOLDER:case c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE:case c("MercuryPayloadSource").CLIENT_DELETE_MESSAGES:case c("MercuryPayloadSource").CLIENT_DELETE_THREAD:case c("MercuryPayloadSource").CLIENT_SEND_MESSAGE:case c("MercuryPayloadSource").SERVER_SEND_MESSAGE:case c("MercuryPayloadSource").SERVER_FETCH_THREADLIST_INFO:case c("MercuryPayloadSource").SERVER_THREAD_SYNC:case c("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE:case c("MercuryPayloadSource").CLIENT_UPDATE_COMM_STATUS:return true;case c("MercuryPayloadSource").SERVER_INITIAL_DATA:return!!o.ordered_threadlists;default:return false}}var n=new(c("MercurySingletonProvider"))(l);f.exports=l}),null);