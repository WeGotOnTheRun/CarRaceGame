if (self.CavalryLogger) { CavalryLogger.start_js(["vB6hT"]); }

__d("MessengerContextualActions.react",["cx","ContextualLayerUpdateOnScroll","LayerHideOnBlur","Link.react","React","ReactAbstractContextualDialog","ReactLayer"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k,l,m=c("React").PropTypes,n=c("ReactLayer").createClass(c("ReactAbstractContextualDialog").createSpec({displayName:"MessengerContextualActionsDialog",theme:{wrapperClassName:"_hw2",arrowDimensions:{offset:12,length:12}}}));i=babelHelpers.inherits(o,c("React").Component);j=i&&i.prototype;o.prototype.render=function(){var q=this.props,r=q.children,s=babelHelpers.objectWithoutProperties(q,["children"]);return c("React").createElement(n,babelHelpers["extends"]({alignment:"center",behaviors:{ContextualLayerUpdateOnScroll:c("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:c("LayerHideOnBlur")}},s,{onToggle:this.props.onToggle}),c("React").createElement("ul",{className:"_hw3"},r))};function o(){i.apply(this,arguments)}o.propTypes={onToggle:m.func};o.Item=p;k=babelHelpers.inherits(p,c("React").Component);l=k&&k.prototype;p.prototype.render=function(){return c("React").createElement("li",{className:"_hw4"},c("React").createElement(c("Link.react"),{className:"_hw5",onClick:this.props.onClick},this.props.children))};function p(){k.apply(this,arguments)}p.propTypes={onClick:m.func};f.exports=o}),null);
__d("XMessengerDotComSaveController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/save/message/",{})}),null);
__d("messengerDeleteMessageDialogReact",["fbt","bs_curry","ReasonReact.bs","messengerDialogReact","messengerDialogBodyReact"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("ReasonReact.bs").statelessComponent("MessengerDeleteMessageDialogReact");function j(){return h._("\u062d\u0630\u0641 \u0627\u0644\u0631\u0633\u0627\u0644\u0629")}var k=h._("\u0647\u0644 \u062a\u0631\u064a\u062f \u0628\u0627\u0644\u062a\u0623\u0643\u064a\u062f \u062d\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u0631\u0633\u0627\u0644\u0629\u061f");function l(){return h._("\u062d\u0630\u0641")}function m(o,p,q,r){var s=function s(){c("bs_curry")._1(o,false);return c("bs_curry")._1(p,0)},t=i.slice();t[9]=function(){return c("ReasonReact.bs").element(0,0,c("messengerDialogReact").Dialog[0](0,o,0,0,0,0,0,[c("ReasonReact.bs").element(0,0,c("messengerDialogReact").Header[0](0,0,j(0))),c("ReasonReact.bs").element(0,0,c("messengerDialogBodyReact").make(0,[k])),c("ReasonReact.bs").element(0,0,c("messengerDialogReact").Footer[0](0,0,[c("ReasonReact.bs").element(0,0,c("messengerDialogReact").CancelButton[0]([q],[])),c("ReasonReact.bs").element(0,0,c("messengerDialogReact").Button[0](0,[l(0)],0,["danger"],[s],[0],0,0,[]))]))]))};return t}var n=c("ReasonReact.bs").wrapReasonForJs(i,function(o){return m(o.onToggle,o.onDelete,o.onCancel,[])});g.component=i;g.renderDialogHeaderMsg=j;g.dialogBodyMsg=k;g.renderDialogButtonMsg=l;g.make=m;g.jsComponent=n}),null);
__d("messengerSaveMessageDialogReact",["fbt","URI","bs_curry","LinkReact.bs","CurrentUser","ReasonReact.bs","messengerDialogReact","messengerDialogBodyReact","CollectionCurationReferrerTags","XSavedForLaterDashboardController","CollectionCurationReferrerParamNames"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("ReasonReact.bs").statelessComponent("MessengerSaveMessageDialogReact"),j=c("XSavedForLaterDashboardController").getURIBuilder().getURI(),k=c("CurrentUser").isWorkUser()?h._("\u062c\u0627\u0631\u064d \u0627\u0644\u062d\u0641\u0638 \u0625\u0644\u0649 Workplace"):h._("\u062c\u0627\u0631\u064d \u0627\u0644\u062d\u0641\u0638 \u0625\u0644\u0649 \u0641\u064a\u0633\u0628\u0648\u0643");function l(o){var p=new(c("URI"))(location.href).getSubdomain();return j.setDomain("subdomain.facebook.com").setSubdomain(p).setProtocol("https").setQueryData(o)}function m(o,p){__p&&__p();var q=i.slice();q[9]=function(){var r={};r[c("CollectionCurationReferrerParamNames").CLICK_REF]=c("CollectionCurationReferrerTags").MESSENGER_DOT_COM_SAVE_CONFIRMATION;var s=l(r);return c("ReasonReact.bs").element(0,0,c("messengerDialogReact").Dialog[0](0,o,0,0,0,0,0,[c("ReasonReact.bs").element(0,0,c("messengerDialogReact").Header[0](0,0,k)),c("ReasonReact.bs").element(0,0,c("messengerDialogBodyReact").make(0,[c("ReasonReact.bs").element(0,0,c("LinkReact.bs").make(0,0,0,0,0,0,[s],0,0,0,0,0,0,["_blank"],0,h._("\u0639\u0631\u0636 \u0627\u0644\u0639\u0646\u0627\u0635\u0631 \u0627\u0644\u0645\u062d\u0641\u0648\u0638\u0629")))]))]))};q[13]=function(){return[[function(){return setTimeout(function(){return c("bs_curry")._1(o,false)},2e3)},function(r){clearTimeout(r);return 0}],0]};return q}var n=c("ReasonReact.bs").wrapReasonForJs(i,function(o){return m(o.onToggle,[])});g.component=i;g.savedForLaterURI=j;g.getSaveMessage=k;g.getDashUri=l;g.make=m;g.jsComponent=n}),null);
__d("MessengerMessageActions.react",["cx","fbt","CurrentUser","FBClipboardLink.react","ImmutableObject","ReactLayeredComponentMixin_DEPRECATED","MercuryAttachmentType","MercuryMessageActions","MercuryMessageInfo","gkx","messengerDialogsRe","MessengerContextualActions.react","messengerDeleteMessageDialogReact","MessengerReactionsMenu.react","React","AsyncRequest","CollectionsDisplaySurface","CollectionCurationMechanisms","MessengerConfig","MessengerDotComSaveModule","messengerSaveMessageDialogReact","messengerURIUtilsRe","SaveMessageUtils","SavedStateActions","URLMatcher","XMessengerDotComSaveController","idx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("messengerDeleteMessageDialogReact").jsComponent,k=c("messengerSaveMessageDialogReact").jsComponent,l=c("MessengerContextualActions.react").Item,m=c("React").PropTypes,n=c("React").createClass({displayName:"MessengerMessageActions",mixins:[c("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{hasFormatting:m.func,isActive:m.bool,isDeletable:m.bool,isFromViewer:m.bool,isShowingOriginal:m.bool,includeReactions:m.bool,message:m.instanceOf(c("ImmutableObject")).isRequired,onToggleOriginal:m.func,onShowMenu:m.func.isRequired},getDefaultProps:function o(){return{isDeletable:true}},getInitialState:function o(){return{shown:false}},render:function o(){return this.props.isActive?c("React").createElement("span",{className:"_2rvp",ref:"actions",onClick:this._toggleShown},this.renderMenu()):null},renderMenu:function o(){if(!this.state.open)return null;return c("React").createElement(c("MessengerReactionsMenu.react"),{entryPoint:"dot_menu",message:this.props.message,onHide:this._hidePopover,refProp:function(){return this.refs.actions}.bind(this),useChatEmojiReact:c("gkx")("AT6A1OO2lJlnHHdkzHOPkllgq2YBSZ42wJAnMnfeaJEnCNUkgcLE__VIZKrcnnkybvVMYEfu3rwvCBYOLMeSgn0B")})},_openPopover:function o(){this.setState({open:true,shown:false})},_hidePopover:function o(){this.setState({open:false})},renderLayers:function o(){__p&&__p();if(!this.state.shown)return{};var p=[];p.push(c("React").createElement(l,{key:"delete",onClick:this._handleDelete},this._renderActionItemMsg()));var q=this._getLinkToAttachment();if(q&&c("MessengerConfig").CopyAttachmentLink)p.push(c("React").createElement(l,{key:"copy-link",onClick:this._handleLink},this._renderCopyAttachmentLinkMsg(q)));if(this.props.hasFormatting&&this.props.hasFormatting()&&this.props.onToggleOriginal)p.push(c("React").createElement(l,{key:"view-source",onClick:this._handleToggleOriginal},this._renderShowOriginalMsg()));if(this._canSaveMessage())p.push(c("React").createElement(l,{key:"save",onClick:this._handleSave},this._renderSaveItemMsg()));if(c("MessengerConfig").ShowMessageLinks)p.push(c("React").createElement(l,{key:"react",onClick:this._handleLink},this._renderLinkItemMsg()));if(this.props.includeReactions)p.push(c("React").createElement(l,{key:"perma-link",onClick:this._openPopover},this._renderReactionMsg()));return{contextualDialog:c("React").createElement(c("MessengerContextualActions.react"),{context:this.refs.actions,onToggle:this._handleActionsToggle,shown:this.props.isActive},this._renderRetry(),p)}},_toggleShown:function o(){this.setState({shown:!this.state.shown},function(){return this.props.onShowMenu(this.state.shown)}.bind(this))},_renderActionItemMsg:function o(){return i._("\u062d\u0630\u0641")},_renderSaveItemMsg:function o(){return c("CurrentUser").isWorkUser()?i._("\u062d\u0641\u0638 \u0625\u0644\u0649 Workplace"):i._("\u062d\u0641\u0638 \u0625\u0644\u0649 \u0641\u064a\u0633\u0628\u0648\u0643")},_renderReactionMsg:function o(){return i._("\u062a\u0641\u0627\u0639\u0644")},_renderShowOriginalMsg:function o(){if(this.props.isShowingOriginal)return i._("\u0639\u0631\u0636 \u0627\u0644\u0645\u062d\u062a\u0648\u0649 \u0627\u0644\u0645\u0646\u0633\u064e\u0651\u0642");else return i._("\u0639\u0631\u0636 \u0627\u0644\u0645\u062d\u062a\u0648\u0649 \u0627\u0644\u0623\u0635\u0644\u064a")},_renderCopyAttachmentLinkMsg:function o(p){var q=i._("\u0646\u0633\u062e \u0631\u0627\u0628\u0637 \u0627\u0644\u0645\u0634\u0627\u0631\u0643\u0629");return c("React").createElement(c("FBClipboardLink.react"),{suppress:true,tooltip:q,value:p},q)},_renderLinkItemMsg:function o(){var p=c("messengerURIUtilsRe").getURIForMessageID(this.props.message.message_id).getQualifiedURIBase().toString(),q=i._("\u0646\u0633\u062e \u0627\u0644\u0631\u0627\u0628\u0637");return c("React").createElement(c("FBClipboardLink.react"),{suppress:true,tooltip:"",value:p},q)},_renderRetry:function o(){if(!c("MercuryMessageInfo").hasError(this.props.message))return null;return c("React").createElement(l,{onClick:this._handleRetry},i._("\u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062e\u0631\u0649"))},_handleActionsToggle:function o(p){!p&&this._handleDeselect()},_handleDeselect:function o(){this.setState({shown:false},function(){return this.props.onShowMenu(this.state.shown)}.bind(this))},_handleDelete:function o(){var p=this.props.message;c("messengerDialogsRe").showDialog(function(){return c("React").createElement(j,{onDelete:function q(){c("MercuryMessageActions").get()["delete"](p.thread_id,[p.message_id])},onToggle:this._handleDialogToggle,onCancel:this._handleDeselect,isFromViewer:this.props.isFromViewer})}.bind(this))},_getLinkToAttachment:function o(){var p,q=this.props.message;return(p=q)!=null?(p=p.attachments)!=null?(p=p[0])!=null?(p=p.share)!=null?p.uri:p:p:p:p},_canSaveMessage:function o(){__p&&__p();var p=this.props.message;if(c("MessengerDotComSaveModule").enabled_messenger_save&&this._isSavableMessageAttachment())return true;if(c("MessengerDotComSaveModule").enabled_messenger_save&&p.attachments&&p.attachments.length>0&&p.attachments[0].share&&p.attachments[0].share.media&&p.attachments[0].share.media.playable)return true;if(c("MessengerDotComSaveModule").enabled_messenger_save){var q=c("URLMatcher").match(p.body);if(q!=null&&q.length>0)return true}return false},_handleLink:function o(){this._handleActionsToggle(false)},_isSavableMessageAttachment:function o(){__p&&__p();var p=this.props.message.attachments;if(!p||p.length===0)return false;for(var q=0;q<p.length;q++){var r=p[q],s=false;if(r.share&&r.share.style_list){var t=r.share.style_list;s=c("SaveMessageUtils").isSavableMessageAttachment(t)}else s=r.attach_type===c("MercuryAttachmentType").VIDEO;if(!s)return false}return true},_handleSave:function o(){var p=this.props.message,q=c("CollectionsDisplaySurface").MESSENGER_DOT_COM_MESSAGE,r=c("CollectionCurationMechanisms").RIGHT_CLICK;new(c("AsyncRequest"))().setURI(c("XMessengerDotComSaveController").getURIBuilder().getURI()).setData({action:c("SavedStateActions").SAVE,surface:q,mechanism:r,message_id:p.message_id}).send();c("messengerDialogsRe").showDialog(function(){return c("React").createElement(k,{onToggle:this._handleDialogToggle})}.bind(this));this._handleActionsToggle(false)},_handleDialogToggle:function o(p){if(!p)c("messengerDialogsRe").removeDialog()},_handleRetry:function o(){this._handleDeselect();c("MercuryMessageActions").get().resend(this.props.message)},_handleToggleOriginal:function o(){this.props.onToggleOriginal&&this.props.onToggleOriginal();this._handleActionsToggle(false)}});f.exports=n}),null);