if (self.CavalryLogger) { CavalryLogger.start_js(["8\/Gp3"]); }

__d("NotificationCounter",["Arbiter","CrossWindowEventEmitter","CurrentUser","DocumentTitle","FavIcon","JSLogger","MercuryConfig","MessengerEnvironment"],(function a(b,c,d,e,f,g){__p&&__p();var h=new(c("CrossWindowEventEmitter"))("JewelBase"),i={messages:0,notifications:0,requests:0},j={init:function k(){c("Arbiter").subscribe("update_title",this._handleUpdate.bind(this));c("Arbiter").subscribe("jewel/count-updated",this._handleCountUpdate.bind(this));h.addListener("count-updated",function(l){this._handleCountUpdate("",l)}.bind(this));if(c("MercuryConfig").FaviconBadge&&!c("CurrentUser").isWorkUser())c("FavIcon").setToggleResources(c("MercuryConfig").FaviconBadgedURL)},getCount:function k(){__p&&__p();var l=0;for(var m in i){var n=Number(i[m]);if(typeof i[m]=="string"&&isNaN(n))return i[m];if(isNaN(n)||n<0){c("JSLogger").create("jewels").error("bad_count",{jewel:m,count:i[m]});continue}l+=n}return l},updateTitle:function k(){if(c("MessengerEnvironment").messengerui)return;var l=this.getCount(),m=c("DocumentTitle").get();m=l?"("+l+") "+m:m;c("DocumentTitle").set(m,true);if(c("MercuryConfig").FaviconBadge)c("FavIcon").toggleSet(parseInt(l,10)>0)},_handleCountUpdate:function k(l,m){i[m.jewel]=m.count;this.updateTitle()},_handleUpdate:function k(l,m){this.updateTitle()}};f.exports=j}),null);
__d("NotificationJewelController",["Arbiter","Bootloader","Event","EventProfiler","FunnelLogger","NotificationConstants","NotificationCounter","NotificationJewelFunnelLoggingConstants","NotificationSeenState","NotificationStore","NotificationUpdates","XWorkHubController","createObjectFrom","curry","gkx","isInFocusMode","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("NotificationConstants").PayloadSourceType,i=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_NAME,j=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,k=0,l=false;function m(o){var p=c("isInFocusMode")(),q=c("NotificationSeenState").getUnseenCount();c("Arbiter").inform("jewel/count-updated",{jewel:o,count:p?0:q,animation:!p&&l&&q>0?"heart":"none"},c("Arbiter").BEHAVIOR_STATE)}function n(o,p){"use strict";__p&&__p();var q=p.badgeAnimationData,r=p.endPoint,s=p.list,t=p.startTime,u=p.unseenNotifs;if(r)c("NotificationStore").registerEndpoint({endpointURI:r});c("NotificationCounter").init();var v=false,w=null,x=c("Event").listen(o.getRoot(),"mouseover",function(){if(!v){v=true;w=c("EventProfiler").notifyRunningEagerInteraction(["Notifications_Jewel_Button"],"click")}c("FunnelLogger").startFunnel(i);x&&x.remove();x=null;s.open();c("FunnelLogger").appendAction(i,j.MOUSE_OVER_ON_JEWEL)}),y=null;c("Event").listen(o.getRoot(),"mouseover",function(){y=c("setTimeoutAcrossTransitions")(function(){c("Bootloader").loadModules(["QE2Logger"],function(C){C.logExposureForUser("www_jewel_tooltip_experiment")},"NotificationJewelController");y=null},500)});c("Event").listen(o.getRoot(),"mouseout",function(){if(y)clearTimeout(y)});if(c("gkx")("AT7qvBGeY3qi4kzGsfSdDBRKoyiGhUCE2HY_OLm4gW_hIR5XTy870z-6Bh0Vp_U80-c"))c("Event").listen(o.getButton(),"click",function(C){if(C.metaKey||C.ctrlKey){var D=c("XWorkHubController").getURIBuilder().setString("ref","jewel").setString("tab","all").getURI();window.open(D,"notification_hub_tab_identifier")}});var z=false,A=o.subscribe("opened",function(){if(!z){z=true;c("EventProfiler").tagCurrentActiveInteractionsAs("FirstNotificationJewelOpen")}if(w)w();A&&A.unsubscribe();A=null;s.open()}),B=s.pause.bind(s);o.subscribe("opened",function(){setTimeout(B,0);m(o.name);c("Bootloader").loadModules(["NotificationVPVs"],function(C){return C.clearImpressions()},"NotificationJewelController");c("Arbiter").inform("notificationJewel/opened")});o.subscribe("closed",function(){s.unpause();m(o.name);c("Arbiter").inform("notificationJewel/closed")});c("NotificationUpdates").subscribe("seen-state-updated",c("curry")(m,o.name));if(q){if(q.logWithQEUniverse)c("Bootloader").loadModules(["QE2Logger"],function(C){return C.logExposureForUser(q.logWithQEUniverse)},"NotificationJewelController");if(q.injectWithAnimation)c("Bootloader").loadModules(["RelationshipDelightsBadge"],function(C){return C.inject(o,q.injectWithAnimation)},"NotificationJewelController");c("Bootloader").loadModules(["RelationshipDelightUtils"],function(C){__p&&__p();c("NotificationUpdates").subscribe("update-notifications",function(D,E){var F=E.nodes,G=E.payloadsource,H=F&&F.length?F.filter(C.shouldHeartBadge):null;if(H&&H.length){l=true;if(q.injectWithAnimation)if(G===h.INITIAL_LOAD||G===h.INITIAL_SEND)C.logBadgeAnimation(H[0].alert_id)}else l=false});if(q.logWithAlertID)C.logBadgeAnimation(q.logWithAlertID)},"NotificationJewelController")}c("NotificationUpdates").handleUpdate(h.INITIAL_LOAD,{seenState:c("createObjectFrom")(u,k)});m(o.name);c("NotificationUpdates").setEndPoint(r)}f.exports=n}),null);
__d("NotificationBucketUtils",["JSResource"],(function a(b,c,d,e,f,g){"use strict";var h={getCustomModuleForType:function i(j){switch(j){case"TICKER":return c("JSResource")("NotificationBucketTicker.react").__setRef("NotificationBucketUtils");default:return null}}};f.exports=h}),null);
__d("NotificationAsyncWrapper",["NotificationListConfig","React"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=c("NotificationListConfig").reactFiberAsyncNotifications?c("React").unstable_AsyncComponent:c("React").Component;h=babelHelpers.inherits(k,j);i=h&&h.prototype;k.prototype.render=function(){return this.props.children};function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("NotificationJewelListBucketHeader.react",["cx","React"],(function a(b,c,d,e,f,g,h){"use strict";function i(j){return c("React").createElement("div",{className:"_fyy"},j.title.toUpperCase())}f.exports=i}),null);
__d("NotificationBucketGeneric.react",["cx","NotificationJewelListBucketHeader.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){var l=this.props,m=l.title,n=l.ids,o=l.listRenderer,p=l.startIndex;if(n.length===0)return null;var q=o(n,p);return c("React").createElement("div",{className:"_32hm"},m?c("React").createElement(c("NotificationJewelListBucketHeader.react"),{title:m}):null,c("React").createElement("ul",null,q))};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("NotificationBucket.react",["cx","BootloadedComponent.react","NotificationBucketGeneric.react","NotificationBucketUtils","NotificationJewelListBucketHeader.react","React","XUISpinner.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.$NotificationBucket1=function(){var l=this.props.bucket,m=l.bucketType,n=l.title;return c("React").createElement("div",null,c("React").createElement(c("NotificationJewelListBucketHeader.react"),{title:n,bucketType:m}),c("React").createElement(c("XUISpinner.react"),{className:"_1e00"}))};k.prototype.render=function(){var l=this.props,m=l.bucket,n=l.listRenderer,o=l.startIndex,p=m.bucketType,f=c("NotificationBucketUtils").getCustomModuleForType(p);if(!f)return c("React").createElement(c("NotificationBucketGeneric.react"),babelHelpers["extends"]({},m,{listRenderer:n,startIndex:o}));return c("React").createElement(c("BootloadedComponent.react"),babelHelpers["extends"]({bootloadLoader:f,bootloadPlaceholder:this.$NotificationBucket1()},m))};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("WebNotificationsBottomCollisionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:WebNotificationsBottomCollisionsLoggerConfig",this.$WebNotificationsBottomCollisionsTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:WebNotificationsBottomCollisionsLoggerConfig",this.$WebNotificationsBottomCollisionsTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$WebNotificationsBottomCollisionsTypedLogger1={};return this};h.prototype.updateData=function(j){this.$WebNotificationsBottomCollisionsTypedLogger1=babelHelpers["extends"]({},this.$WebNotificationsBottomCollisionsTypedLogger1,j);return this};h.prototype.setVC=function(j){this.$WebNotificationsBottomCollisionsTypedLogger1.vc=j;return this};var i={vc:true};f.exports=h}),null);
__d("NotificationJewelList.react",["cx","fbt","Animation","ErrorBoundary.react","Event","EventProfiler","FunnelLogger","JewelLogger","LogicalGrid.react","NotificationBucket.react","NotificationJewelFunnelLoggingConstants","NotificationListConfig","NotificationListItem.react","NotificationListPropTypes","NotificationVPVs","NotifTestIDs","QE2Logger","React","ReactDOM","ScrollableArea.react","SubscriptionsHandler","TimeSlice","Vector","WebNotificationsBottomCollisionsTypedLogger","XUISpinner.react","debounce","getObjectValues","isEmpty","performanceNowNoFallback","throttle"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_NAME,m=c("NotificationJewelFunnelLoggingConstants").FUNNEL_LOGGING_EVENT,n=c("NotificationListConfig").numStoriesFromEndBeforeAFetchIsTriggered,o=160,p=530,q=61,r=Math.ceil(q*n),s=430,t=void 0;function u(w){if(t!=w){new(c("WebNotificationsBottomCollisionsTypedLogger"))().log();t=w}}j=babelHelpers.inherits(v,c("React").Component);k=j&&j.prototype;function v(){__p&&__p();var w,x;"use strict";for(var y=arguments.length,z=Array(y),A=0;A<y;A++)z[A]=arguments[A];return x=(w=k.constructor).call.apply(w,[this].concat(z)),this.state={lastMeasuredHeight:null},this.$NotificationJewelList2=[],this.$NotificationJewelList6=new(c("SubscriptionsHandler"))(),this.$NotificationJewelList7=false,this.$NotificationJewelList8=false,this.$NotificationJewelList11=function(){__p&&__p();if(!this.$NotificationJewelList3||!this.$NotificationJewelList5)return;var B=c("ReactDOM").findDOMNode(this.$NotificationJewelList3);if(!B)return;var C=c("ReactDOM").findDOMNode(this.$NotificationJewelList5);if(!C)return;var D=c("NotificationVPVs").getValidatedRectangle(C);if(this.props.afterScroll){var E=function(){this.props.afterScroll(this.$NotificationJewelList9(),B,D)}.bind(this),F=c("Vector").getElementDimensions(C).y,G=this.$NotificationJewelList5&&this.$NotificationJewelList5.getArea();if(G&&G.getContentHeight()>0&&this.$NotificationJewelList7===false&&c("performanceNowNoFallback")&&c("getObjectValues")(this.props.notifs).length>0){this.$NotificationJewelList7=true;c("JewelLogger").logJewelListComponentEvent({jewelName:"notifications",eventName:"list_population_initial",timestamp:c("performanceNowNoFallback")()})}if(G&&F>0&&G.getContentHeight()>=F){if(this.$NotificationJewelList8===false&&c("performanceNowNoFallback")){this.$NotificationJewelList8=true;c("JewelLogger").logJewelListComponentEvent({jewelName:"notifications",eventName:"list_populated",timestamp:c("performanceNowNoFallback")()})}c("TimeSlice").guard(E,"NotificationJewelList afterScrollCallback",{propagationType:c("TimeSlice").PropagationType.ORPHAN})()}else E()}}.bind(this),this.$NotificationJewelList12=function(){return c("getObjectValues")(this.props.notifs).map(function(B){return JSON.stringify(B)})}.bind(this),this.$NotificationJewelList16=function(B,C){__p&&__p();var D,E=this,F=this.$NotificationJewelList13(C);if(B.ids&&B.ids.length){var D=function(){var G=E.props.notifs,H=B.ids.filter(function(I){return!!G[I]});if(H.length===0)return{v:null}}();if(typeof D==="object")return D.v}return c("React").createElement("li",{key:C},c("React").createElement(c("NotificationBucket.react"),{bucket:B,listRenderer:this.$NotificationJewelList17,startIndex:F}))}.bind(this),this.$NotificationJewelList17=function(B,C){C=C||0;return B.map(function(D,E){var F=this.props.notifs[D];if(!F)return null;var G=E+C;return this.$NotificationJewelList18(F,G,G)}.bind(this))}.bind(this),this.$NotificationJewelList19=function(){this.setState(function(B){return babelHelpers["extends"]({},B,{lastMeasuredHeight:this.$NotificationJewelList10()})}.bind(this))}.bind(this),this.$NotificationJewelList20=function(){var B=c("debounce")(this.$NotificationJewelList19);this.$NotificationJewelList6.addSubscriptions(B);return B}.bind(this)(),this.$NotificationJewelList23=function(){c("FunnelLogger").appendAction(l,m.SCROLL_TO_FETCH);this.$NotificationJewelList11()}.bind(this),this.$NotificationJewelList24=c("throttle").acrossTransitionsWithBlocking(this.$NotificationJewelList23),x}v.prototype.$NotificationJewelList9=function(){"use strict";__p&&__p();if(!this.$NotificationJewelList4||!this.$NotificationJewelList5)return false;var w=c("ReactDOM").findDOMNode(this.$NotificationJewelList5);if(!w)return false;var x=c("ReactDOM").findDOMNode(this.$NotificationJewelList4);if(!x)return false;var y=c("Vector").getElementDimensions(w).y;if(y===0)return false;var z=c("Vector").getElementPosition(w).y+y,A=c("Vector").getElementPosition(x).y,B=this.$NotificationJewelList5&&this.$NotificationJewelList5.getArea();if(B&&B.getScrollTop()>0&&A<z)u(c("getObjectValues")(this.props.notifs).length);c("QE2Logger").logExposureForUser("www_notifications_perf_h2_2017");return A-r<z};v.prototype.$NotificationJewelList10=function(){"use strict";var w=c("Vector").getViewportDimensions().y,x=Math.min(this.props.maxHeight||p,w-o);return x};v.prototype.$NotificationJewelList13=function(w){"use strict";return this.$NotificationJewelList2.slice(0,w).reduce(function(x,y){return x+y},0)};v.prototype.$NotificationJewelList14=function(w){"use strict";this.$NotificationJewelList2=w?w.map(function(x){return x.ids.length}):[]};v.prototype.$NotificationJewelList15=function(){"use strict";if(!this.props.buckets)return null;return this.props.buckets.map(this.$NotificationJewelList16)};v.prototype.$NotificationJewelList18=function(w,x,y){"use strict";var z=w.alert_id;return c("React").createElement(c("ErrorBoundary.react"),{key:z},c("React").createElement(c("NotificationListItem.react"),{getDebugData:this.$NotificationJewelList12,isRead:this.props.readState[z],onChevronHide:this.props.onChevronHide,onChevronShow:this.props.onChevronShow,onClick:this.props.onClick,onRead:this.props.onRead,parent:this,paused:this.props.paused,row:x,rowIndex:y,shortenTimestamp:this.props.shortenTimestamp,visible:!this.props.hiddenState[z],notification:w}))};v.prototype.$NotificationJewelList21=function(w){"use strict";if(this.props.onNumNotificationsViewableChange)this.props.onNumNotificationsViewableChange(w/q)};v.prototype.componentWillMount=function(){"use strict";this.$NotificationJewelList14(this.props.buckets);this.$NotificationJewelList6.addSubscriptions(c("Event").listen(window,"resize",this.$NotificationJewelList20));this.$NotificationJewelList19()};v.prototype.componentDidMount=function(){"use strict";var w=this.state.lastMeasuredHeight;if(w!=null)this.$NotificationJewelList21(w);if(c("performanceNowNoFallback"))c("JewelLogger").logJewelListComponentEvent({jewelName:"notifications",eventName:"list_did_mount",timestamp:c("performanceNowNoFallback")()})};v.prototype.componentWillReceiveProps=function(w){"use strict";if(w.buckets===this.props.buckets)return;this.$NotificationJewelList14(w.buckets)};v.prototype.componentDidUpdate=function(w,x){"use strict";__p&&__p();if(this.props.paused&&!w.paused)if(this.props.shouldScroll&&this.$NotificationJewelList5){var y=this.$NotificationJewelList5.getArea();if(y)y.scrollToTop(false)}var z=this.state.lastMeasuredHeight;if(z!=null&&z!==x.lastMeasuredHeight){this.$NotificationJewelList21(z);if(this.$NotificationJewelList1){this.$NotificationJewelList1.stop();delete this.$NotificationJewelList1}if(!c("isEmpty")(this.props.notifs)){var A=c("ReactDOM").findDOMNode(this.$NotificationJewelList5);if(A)this.$NotificationJewelList1=new(c("Animation"))(A).to("height",z+"px").duration(100).go()}}var B=setTimeout(this.$NotificationJewelList11,0);this.$NotificationJewelList6.addSubscriptions({remove:function C(){clearTimeout(B)}})};v.prototype.componentWillUnmount=function(){"use strict";this.$NotificationJewelList6.release();if(this.$NotificationJewelList1){this.$NotificationJewelList1.stop();delete this.$NotificationJewelList1}};v.prototype.$NotificationJewelList22=function(w,x){"use strict";return x.indexOf(w)};v.prototype.$NotificationJewelList25=function(){"use strict";if(this.props.buckets&&this.props.buckets.length)return this.$NotificationJewelList15();var w=c("getObjectValues")(this.props.notifs).filter(Boolean).map(function(x){return x.alert_id});return c("getObjectValues")(this.props.notifs).filter(Boolean).map(function(x,y){var z=x.alert_id,A=this.$NotificationJewelList22(z,w);return this.$NotificationJewelList18(x,A,y)}.bind(this))};v.prototype.render=function(){"use strict";__p&&__p();var w=this.props.notifs,x=null,y=null,z=s,A=null,B=c("React").createElement("ul",{"data-gt":this.props.tracking,"data-testid":c("NotifTestIDs").REACT_NOTIF_LIST});if(!c("isEmpty")(w)){x=c("React").createElement(c("LogicalGrid.react"),{ref:function(G){return this.$NotificationJewelList3=G}.bind(this),component:B},this.$NotificationJewelList25());y=this.state.lastMeasuredHeight}else if(!this.props.canFetchMore)x=c("React").createElement("div",{className:"_572e","data-testid":c("NotifTestIDs").REACT_NOTIF_LIST},i._("\u0644\u0627 \u062a\u0648\u062c\u062f \u0625\u0634\u0639\u0627\u0631\u0627\u062a \u062c\u062f\u064a\u062f\u0629"));if(this.props.canFetchMore)A=c("React").createElement(c("XUISpinner.react"),{ref:function(G){return this.$NotificationJewelList4=G}.bind(this),paused:!this.props.currentlyFetching,className:"jewelLoading"});var C=null;if(this.props.upsell){var D=this.props.upsell.module;C=c("React").createElement(D,this.props.upsell.props)}var E="_50-t"+(this.props.showingChevron?" _2iy1":""),F=c("React").createElement(c("ScrollableArea.react"),{ref:function(G){return this.$NotificationJewelList5=G}.bind(this),width:z,fade:true,persistent:true,onScroll:this.$NotificationJewelList24},x,A);return c("React").createElement("div",{style:y?{height:y+"px"}:{},className:E},F,C)};v.propTypes=c("NotificationListPropTypes");f.exports=v}),null);